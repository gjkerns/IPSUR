<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
lang="en" xml:lang="en">
<head>
<title>Continuous Distributions</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2011-09-21 17:20:31 EDT"/>
<meta name="author" content="G. Jay Kerns"/>
<meta name="description" content="This chapter discusses continuous random variables and their probabalistic properties."/>
<meta name="keywords" content="continuous random variable R statistics"/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up" style="text-align:right;font-size:70%;white-space:nowrap;">
 <a accesskey="h" href="index.html   "> UP </a>
 |
 <a accesskey="H" href="http://ipsur.org/index.html"> HOME </a>
</div>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">Continuous Distributions</h1>




---
layout: chapter
title: Continuous Distributions
previous: discrete-distributions.html
next: multivariate-distributions.html
description: This chapter discusses continuous random variables and their probabalistic properties.
keywords: continuous random variable R statistics
---



<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Continuous Distributions</a>
<ul>
<li><a href="#sec-1-1">Continuous Random Variables</a>
<ul>
<li><a href="#sec-1-1-1">Probability Density Functions</a></li>
<li><a href="#sec-1-1-2">Expectation of Continuous Random Variables</a></li>
</ul>
</li>
<li><a href="#sec-1-2">The Continuous Uniform Distribution</a></li>
<li><a href="#sec-1-3">The Normal Distribution</a>
<ul>
<li><a href="#sec-1-3-1">Normal Quantiles and the Quantile Function</a></li>
</ul>
</li>
<li><a href="#sec-1-4">Functions of Continuous Random Variables</a>
<ul>
<li><a href="#sec-1-4-1">The PDF Method</a></li>
<li><a href="#sec-1-4-2">The CDF method</a></li>
</ul>
</li>
<li><a href="#sec-1-5">Other Continuous Distributions</a>
<ul>
<li><a href="#sec-1-5-1">Waiting Time Distributions</a></li>
<li><a href="#sec-1-5-2">The Gamma Distribution</a></li>
<li><a href="#sec-1-5-3">The Chi square, Student's \(t\), and Snedecor's \(F\) Distributions</a></li>
<li><a href="#sec-1-5-4">Student's \(t\) distribution</a></li>
<li><a href="#sec-1-5-5">Snedecor's \(F\) distribution</a></li>
<li><a href="#sec-1-5-6">Other Popular Distributions</a></li>
</ul>
</li>
<li><a href="#sec-1-6">Exercises</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">Continuous Distributions</h2>
<div class="outline-text-2" id="text-1">


<p>
The focus of the last chapter was on random variables whose support can be written down in a list of values (finite or countably infinite), such as the number of successes in a sequence of Bernoulli trials. Now we move to random variables whose support is a whole range of values, say, an interval \((a,b)\). It is shown in later classes that it is impossible to write all of the numbers down in a list; there are simply too many of them.
</p>
<p>
This chapter begins with continuous random variables and the associated PDFs and CDFs The continuous uniform distribution is highlighted, along with the Gaussian, or normal, distribution. Some mathematical details pave the way for a catalogue of models.
</p>
<p>
The interested reader who would like to learn more about any of the assorted discrete distributions mentioned below should take a look at <i>Continuous Univariate Distributions, Volumes 1</i> and <i>2</i> by Johnson <i>et al</i> \cite{Johnson1994,Johnson1995}.
</p>


<ul>
<li>how to choose a reasonable continuous model under a variety of physical circumstances

</li>
<li>basic correspondence between continuous versus discrete random variables

</li>
<li>the general tools of the trade for manipulation of continuous random variables, integration, <i>etc</i>.

</li>
<li>some details on a couple of continuous models, and exposure to a bunch of other ones

</li>
<li>how to make new continuous random variables from old ones
</li>
</ul>



</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1">Continuous Random Variables</h3>
<div class="outline-text-3" id="text-1-1">



</div>

<div id="outline-container-1-1-1" class="outline-4">
<h4 id="sec-1-1-1">Probability Density Functions</h4>
<div class="outline-text-4" id="text-1-1-1">


<p>
Continuous random variables have supports that look like
\begin{equation}
S_{X}=[a,b]\mbox{ or }(a,b),
\end{equation}
or unions of intervals of the above form. Examples of random variables that are often taken to be continuous are:
</p>
<ul>
<li>the height or weight of an individual,
</li>
<li>other physical measurements such as the length or size of an object, and
</li>
<li>durations of time (usually).
</li>
</ul>


<p>
Every continuous random variable \(X\) has a <i>probability density function</i> (PDF) denoted \(f_{X}\) associated with it
that satisfies three basic properties:
</p><ol>
<li>\(f_{X}(x)&gt;0\) for \(x\in S_{X}\),
</li>
<li>\(\int_{x\in S_{X}}f_{X}(x)\,\mathrm{d} x=1\), and
</li>
<li>\(\Pr(X\in A)=\int_{x\in A}f_{X}(x)\:\mathrm{d} x\), for an event \(A\subset S_{X}\).
</li>
</ol>


<p>
<div class="rem">
We can say the following about continuous random variables:
</p><ul>
<li>Usually, the set \(A\) in <a href="#enu-contrvcond3"> contrvcond3</a> takes the form of an interval, for example, \(A=[c,d]\), in which case
  \begin{equation}
  \Pr(X\in A)=\int_{c}^{d}f_{X}(x)\:\mathrm{d} x.
  \end{equation}
</li>
<li>It follows that the probability that \(X\) falls in a given interval is simply the <i>area under the curve</i> of \(f_{X}\) over the interval.
</li>
<li>Since the area of a line \(x=c\) in the plane is zero, \(\Pr(X=c)=0\)  for any value \(c\). In other words, the chance that \(X\) equals a particular value \(c\) is zero, and this is true for any number \(c\). Moreover, when \(a&lt;b\) all of the following probabilities are the same:
  \begin{equation}
  \Pr(a\leq X\leq b)=\Pr(a<X\leq b)=\Pr(a\leq X<b)=\Pr(a<X<b).
  \end{equation}
</li>
<li>The PDF \(f_{X}\) can sometimes be greater than 1. This is in contrast to the discrete case; every nonzero value of a PMF is a probability which is restricted to lie in the interval \([0,1]\).
</li>
</ul>


<p>
</div>
</p>
<p>
We met the cumulative distribution function, \(F_{X}\), in Chapter <a href="#cha-Discrete-Distributions">Discrete-Distributions</a>. Recall that it is defined by \(F_{X}(t)=\Pr(X\leq t)\), for \(-\infty&lt;t&lt;\infty\). While in the discrete case the CDF is unwieldy, in the continuous case the CDF has a relatively convenient form:
\begin{equation}
F_{X}(t)=\Pr(X\leq t)=\int_{-\infty}^{t}f_{X}(x)\:\mathrm{d} x,\quad-\infty<t<\infty.
\end{equation}

<div class="rem">
For any continuous CDF \(F_{X}\) the following are true.
</p><ul>
<li>\(F_{X}\) is nondecreasing , that is, \(t_{1}\leq t_{2}\) implies \(F_{X}(t_{1})\leq F_{X}(t_{2})\).
</li>
<li>\(F_{X}\) is continuous (see Appendix <a href="#sec-Differential-and-Integral">Differential-and-Integral</a>). Note the distinction from the discrete case: CDFs of discrete random variables are not continuous, they are only right continuous.
</li>
<li>\(\lim_{t\to-\infty}F_{X}(t)=0\) and \(\lim_{t\to\infty}F_{X}(t)=1\).
</li>
</ul>


<p>
</div>
</p>
<p>
There is a handy relationship between the CDF and PDF in the continuous case. Consider the derivative of \(F_{X}\):
\begin{equation}
F'_{X}(t)=\frac{\mathrm{d}}{\mathrm{d} t}F_{X}(t)=\frac{\mathrm{d}}{\mathrm{d} t}\,\int_{-\infty}^{t}f_{X}(x)\,\mathrm{d} x=f_{X}(t),
\end{equation}
the last equality being true by the Fundamental Theorem of Calculus, part (2) (see Appendix <a href="#sec-Differential-and-Integral">Differential-and-Integral</a>). In short, \((F_{X})'=f_{X}\) in the continuous case
</p>
</div>

</div>

<div id="outline-container-1-1-2" class="outline-4">
<h4 id="sec-1-1-2">Expectation of Continuous Random Variables</h4>
<div class="outline-text-4" id="text-1-1-2">


<p>
For a continuous random variable \(X\) the expected value of \(g(X)\) is
\begin{equation}
\mathbb{E} g(X)=\int_{x\in S}g(x)f_{X}(x)\:\mathrm{d} x,
\end{equation}
provided the (potentially improper) integral \(\int_{S}|g(x)|\, f(x)\mathrm{d} x\) is convergent. One important example is the mean \(\mu\), also known as \(\mathbb{E} X\):
\begin{equation}
\mu=\mathbb{E} X=\int_{x\in S}xf_{X}(x)\:\mathrm{d} x,
\end{equation}
provided \(\int_{S}|x|f(x)\mathrm{d} x\) is finite. Also there is the variance
\begin{equation}
\sigma^{2}=\mathbb{E}(X-\mu)^{2}=\int_{x\in S}(x-\mu)^{2}f_{X}(x)\,\mathrm{d} x,
\end{equation}
which can be computed with the alternate formula \(\sigma^{2}=\mathbb{E} X^{2}-(\mathbb{E} X)^{2}\). In addition, there is the standard deviation \(\sigma=\sqrt{\sigma^{2}}\). The moment generating function is given by
\begin{equation}
M_{X}(t)=\mathbb{E}\:\mathrm{e}^{tX}=\int_{-\infty}^{\infty}\mathrm{e}^{tx}f_{X}(x)\:\mathrm{d} x,
\end{equation}
provided the integral exists (is finite) for all \(t\) in a neighborhood of \(t=0\).
</p>

<p>
Let the continuous random variable \(X\) have PDF
\[
f_{X}(x)=3x^{2},\quad0\leq x\leq 1.
\]
We will see later that \(f_{X}\) belongs to the <i>Beta</i> family of distributions. It is easy to see that \(\int_{-\infty}^{\infty}f(x)\mathrm{d} x=1\).
\begin{align*}
\int_{-\infty}^{\infty}f_{X}(x)\mathrm{d} x & =\int_{0}^{1}3x^{2}\:\mathrm{d} x\\
 & =\left.x^{3}\right|_{x=0}^{1}\\
 & =1^{3}-0^{3}\\
 & =1.
\end{align*}
This being said, we may find \(\Pr(0.14\leq X&lt;0.71)\).
\begin{align*}
\Pr(0.14\leq X<0.71) & =\int_{0.14}^{0.71}3x^{2}\mathrm{d} x,\\
 & =\left.x^{3}\right|_{x=0.14}^{0.71}\\
 & =0.71^{3}-0.14^{3}\\
 & \approx0.355167.
\end{align*}
We can find the mean and variance in an identical manner.
\begin{align*}
\mu=\int_{-\infty}^{\infty}xf_{X}(x)\mathrm{d} x & =\int_{0}^{1}x\cdot3x^{2}\:\mathrm{d} x,\\
 & =\frac{3}{4}x^{4}|_{x=0}^{1},\\
 & =\frac{3}{4}.
\end{align*}
It would perhaps be best to calculate the variance with the shortcut formula \(\sigma^{2}=\mathbb{E} X^{2}-\mu^{2}\):
\begin{align*}
\mathbb{E} X^{2}=\int_{-\infty}^{\infty}x^{2}f_{X}(x)\mathrm{d} x & =\int_{0}^{1}x^{2}\cdot3x^{2}\:\mathrm{d} x\\
 & =\left.\frac{3}{5}x^{5}\right|_{x=0}^{1}\\
 & =3/5.
\end{align*}
which gives \(\sigma^{2}=3/5-(3/4)^{2}=3/80\).
</p>

<p>
We will try one with unbounded support to brush up on improper integration. Let the random variable \(X\) have PDF
\[
f_{X}(x)=\frac{3}{x^{4}},\quad x>1.
\]
We can show that \(\int_{-\infty}^{\infty}f(x)\mathrm{d} x=1\):
\begin{align*}
\int_{-\infty}^{\infty}f_{X}(x)\mathrm{d} x & =\int_{1}^{\infty}\frac{3}{x^{4}}\:\mathrm{d} x\\
 & =\lim_{t\to\infty}\int_{1}^{t}\frac{3}{x^{4}}\:\mathrm{d} x\\
 & =\lim_{t\to\infty}\ \left.3\,\frac{1}{-3}x^{-3}\right|_{x=1}^{t}\\
 & =-\left(\lim_{t\to\infty}\frac{1}{t^{3}}-1\right)\\
 & =1.
\end{align*}
We calculate \(\Pr(3.4\leq X&lt;7.1)\):
\begin{align*}
\Pr(3.4\leq X<7.1) & =\int_{3.4}^{7.1}3x^{-4}\mathrm{d} x\\
 & =\left.3\,\frac{1}{-3}x^{-3}\right|_{x=3.4}^{7.1}\\
 & =-1(7.1^{-3}-3.4^{-3})\\
 & \approx0.0226487123.
\end{align*}
We locate the mean and variance just like before.
\begin{align*}
\mu=\int_{-\infty}^{\infty}xf_{X}(x)\mathrm{d} x & =\int_{1}^{\infty}x\cdot\frac{3}{x^{4}}\:\mathrm{d} x\\
 & =\left.3\,\frac{1}{-2}x^{-2}\right|_{x=1}^{\infty}\\
 & =-\frac{3}{2}\left(\lim_{t\to\infty}\frac{1}{t^{2}}-1\right)\\
 & =\frac{3}{2}.
\end{align*}
Again we use the shortcut \(\sigma^{2}=\mathbb{E} X^{2}-\mu^{2}\):
\begin{align*}
\mathbb{E} X^{2}=\int_{-\infty}^{\infty}x^{2}f_{X}(x)\mathrm{d} x & =\int_{1}^{\infty}x^{2}\cdot\frac{3}{x^{4}}\:\mathrm{d} x\\
 & =\left.3\:\frac{1}{-1}x^{-1}\right|_{x=1}^{\infty}\\
 & =-3\left(\lim_{t\to\infty}\frac{1}{t^{2}}-1\right)\\
 & =3,
\end{align*}
which closes the example with \(\sigma^{2}=3-(3/2)^{2}=3/4\).
</p>

<p>
There exist utilities to calculate probabilities and expectations for general continuous random variables, but it is better to find a built-in model, if possible. Sometimes it is not possible. We show how to do it the long way, and the <code>distr</code>\index{R packages@\textsf{R} packages!distr@\texttt{distr}} package way.
</p>
<p>
Let \(X\) have PDF \(f(x)=3x^{2}\), \(0&lt;x&lt;1\) and find \(\Pr(0.14\leq X\leq0.71)\). (We will ignore that \(X\) is a beta random variable for the sake of argument.)
</p>



<pre class="src src-R"><span style="color: #0000ff;">f</span> <span style="color: #008b8b;">&lt;-</span> <span style="color: #a020f0;">function</span>(x) 3*x^2
integrate(f, lower = 0.14, upper = 0.71)
</pre>


<pre class="example">
0.3551669999999999 with absolute error &lt; 3.9e-15
</pre>


<p>
Compare this to the answer we found in Example <a href="#exa-cont-pdf3x2">cont-pdf3x2</a>. We could integrate the function \(xf(x)=\) <code>3*x^3</code> from zero to one to get the mean, and use the shortcut \(\sigma^{2}=\mathbb{E} X^{2}-\left(\mathbb{E} X\right)^{2}\) for the variance. 
</p>

<p>
Let \(X\) have PDF \(f(x)=3/x^{4}\), \(x&gt;1\). We may integrate the function \(xf(x)=\) <code>3/x^3</code> from zero to infinity to get the mean of \(X\).
</p>



<pre class="src src-R"><span style="color: #0000ff;">g</span> <span style="color: #008b8b;">&lt;-</span> <span style="color: #a020f0;">function</span>(x) 3/x^3
integrate(g, lower = 1, upper = <span style="color: #228b22;">Inf</span>)
</pre>


<pre class="example">
1.5 with absolute error &lt; 1.7e-14
</pre>


<p>
Compare this to the answer we got in Example <a href="#exa-cont-pdf-3x4">cont-pdf-3x4</a>. Use <code>-Inf</code> for \(-\infty\).
</p>

<p>
Let us redo Example <a href="#exa-cont-pdf3x2">cont-pdf3x2</a> with the <code>distr</code> package. The method is similar to that encountered in Section <a href="#sub-disc-rv-how-r">disc-rv-how-r</a> in Chapter <a href="#cha-Discrete-Distributions">Discrete-Distributions</a>. We define an absolutely continuous random variable:
</p>




<pre class="src src-R"><span style="color: #008b8b;">library</span>(distr)
<span style="color: #0000ff;">f</span> <span style="color: #008b8b;">&lt;-</span> <span style="color: #a020f0;">function</span>(x) 3*x^2
X <span style="color: #008b8b;">&lt;-</span> AbscontDistribution(d = f, low1 = 0, up1 = 1)
p(X)(0.71) - p(X)(0.14)
</pre>


<pre class="example">
[1] 0.3551670172065496
</pre>


<p>
Compare this to the answer we found earlier. Now let us try expectation with the <code>distrEx</code> package \cite{Ruckdescheldistr}:
</p>


<pre class="src src-R"><span style="color: #008b8b;">library</span>(distrEx)
E(X); var(X); 3/80
</pre>


<pre class="example">
[1] 0.7496336769758919
[1] 0.03768305003062056
[1] 0.0375
</pre>


<p>
Compare these answers to the ones we found in Example <a href="#exa-cont-pdf3x2">cont-pdf3x2</a>. Why are they different? Because the <code>distrEx</code> package resorts to numerical methods when it encounters a model it does not recognize. This means that the answers we get for calculations may not exactly match the theoretical values. Be careful.
</p>
</div>
</div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2">The Continuous Uniform Distribution</h3>
<div class="outline-text-3" id="text-1-2">


<p>
A random variable \(X\) with the continuous uniform distribution on the interval \((a,b)\) has PDF
\begin{equation}
f_{X}(x)=\frac{1}{b-a},\quad a<x<b.
\end{equation}
The associated \(\mathsf{R}\) function is \(\mathsf{dunif}(\mathtt{min}=a,\,\mathtt{max}=b)\). We write \(X\sim\mathsf{unif}(\mathtt{min}=a,\,\mathtt{max}=b)\). Due to the particularly simple form of this PDF we can also write down explicitly a formula for the CDF \(F_{X}\):
\begin{equation}
F_{X}(t)=
\begin{cases}
0, & t<0,\\
\frac{t-a}{b-a}, & a\leq t<b,\\
1, & t\geq b.
\end{cases}
\label{eq:unif-cdf}
\end{equation}

The continuous uniform distribution is the continuous analogue of the discrete uniform distribution; it is used to model experiments whose outcome is an interval of numbers that are ``equally likely'' in the sense that any two intervals of equal length in the support have the same probability associated with them.
</p>
<p>
Choose a number in \( [0,1] \) at random, and let \(X\) be the number chosen. Then \(X\sim\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)\).
The mean of \(X\sim\mathsf{unif}(\mathtt{min}=a,\,\mathtt{max}=b)\) is relatively simple to calculate:
\begin{align*}
\mu=\mathbb{E} X & =\int_{-\infty}^{\infty}x\, f_{X}(x)\,\mathrm{d} x,\\
 & =\int_{a}^{b}x\ \frac{1}{b-a}\ \mathrm{d} x,\\
 & =\left.\frac{1}{b-a}\ \frac{x^{2}}{2}\ \right|_{x=a}^{b},\\
 & =\frac{1}{b-a}\ \frac{b^{2}-a^{2}}{2},\\
 & =\frac{b+a}{2},
\end{align*}
using the popular formula for the difference of squares. The variance is left to Exercise <a href="#xca-variance-dunif">variance-dunif</a>.
</p>
</div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3">The Normal Distribution</h3>
<div class="outline-text-3" id="text-1-3">


<p>
We say that \(X\) has a <i>normal distribution</i> if it has PDF
\begin{equation}
f_{X}(x)=\frac{1}{\sigma\sqrt{2\pi}}\exp \{ \frac{-(x-\mu)^{2}}{2\sigma^{2}} \},\quad -\infty < x < \infty.
\end{equation}
We write \(X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\), and the associated \(\mathsf{R}\) function is <code>dnorm(x, mean = 0, sd = 1)</code>.
</p>
<p>
The familiar bell-shaped curve, the normal distribution is also known as the <i>Gaussian distribution</i> because the German mathematician C. F. Gauss largely contributed to its mathematical development. This distribution is by far the most important distribution, continuous or discrete. The normal model appears in the theory of all sorts of natural phenomena, from to the way particles of smoke dissipate in a closed room, to the journey of a bottle in the ocean to the white noise of cosmic background radiation.
</p>
<p>
When \(\mu=0\) and \(\sigma=1\) we say that the random variable has a <i>standard normal</i> distribution and we typically write \(Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\). The lowercase Greek letter phi (\(\phi\)) is used to denote the standard normal PDF and the capital Greek letter phi \(\Phi\) is used to denote the standard normal CDF: for \(-\infty&lt;z&lt;\infty\),
\begin{equation}
\phi(z)=\frac{1}{\sqrt{2\pi}}\,\mathrm{e}^{-z^{2}/2}\mbox{ and }\Phi(t)=\int_{-\infty}^{t}\phi(z)\,\mathrm{d} z.
\end{equation}

<div class="prop">
If \(X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) then
\begin{equation}
Z=\frac{X-\mu}{\sigma}\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1).
\end{equation}
</div>
</p>
<p>
The MGF of \(Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) is relatively easy to derive:
\begin{eqnarray*}
M_{Z}(t) & = & \int_{-\infty}^{\infty}\mathrm{e}^{tz}\frac{1}{\sqrt{2\pi}}\mathrm{e}^{-z^{2}/2}\mathrm{d} z,\\
 & = & \int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}\exp \{ -\frac{1}{2}\left(z^{2}+2tz+t^{2}\right)+\frac{t^{2}}{2} \} \mathrm{d} z,\\
 & = & \mathrm{e}^{t^{2}/2}\left(\int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}\mathrm{e}^{-[z-(-t)]^{2}/2}\mathrm{d} z\right),
\end{eqnarray*}
and the quantity in the parentheses is the total area under a \(\mathsf{norm}(\mathtt{mean}=-t,\,\mathtt{sd}=1)\) density, which is one. Therefore,
\begin{equation}
M_{Z}(t)=\mathrm{e}^{-t^{2}/2},\quad-\infty<t<\infty.
\end{equation}

The MGF of \(X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) is then not difficult either because 
\[
Z=\frac{X-\mu}{\sigma},\mbox{ or rewriting, }X=\sigma Z+\mu.
\]
Therefore
\[
M_{X}(t)=\mathbb{E}\mathrm{e}^{tX}=\mathbb{E}\mathrm{e}^{t(\sigma Z+\mu)}=\mathbb{E}\mathrm{e}^{\sigma tX}\mathrm{e}^{\mu}=\mathrm{e}^{t\mu}M_{Z}(\sigma t),
\]
and we know that \(M_{Z}(t)=\mathrm{e}^{t^{2}/2}\), thus substituting we get
\[
M_{X}(t)=\mathrm{e}^{t\mu}\mathrm{e}^{(\sigma t)^{2}/2}=\exp\left\{ \mu t+\sigma^{2}t^{2}/2\right\} ,
\]
for \(-\infty&lt;t&lt;\infty\).
</p>
<p>
<div class="fact">
The same argument above shows that if \(X\) has MGF \(M_{X}(t)\) then the MGF of \(Y=a+bX\) is
\begin{equation}
M_{Y}(t)=\mathrm{e}^{ta}M_{X}(bt).
\end{equation}
</div>
</p>
<p>
The 68-95-99.7 Rule. We saw in Section <a href="#sub-Measures-of-Spread">Measures-of-Spread</a> that when an empirical distribution is approximately bell shaped there are specific proportions of the observations which fall at varying distances from the (sample) mean. We can see where these come from &ndash; and obtain more precise proportions &ndash; with the following:
</p>



<pre class="src src-R">pnorm(1:3) - pnorm(-(1:3))
</pre>


<pre class="example">
[1] 0.6826894921370859 0.9544997361036416 0.9973002039367398
</pre>


<p>
Let the random experiment consist of a person taking an IQ test, and let \(X\) be the score on the test. The scores on such a test are typically standardized to have a mean of 100 and a standard deviation of 15, and IQ tests have (approximately and notoriously) a bell-shaped distribution. What is \(\Pr(85\leq X\leq115)\)?
</p>
<p>
<i>Solution</i>: this one is easy because the limits 85 and 115 fall exactly one standard deviation (below and above, respectively) from the mean of 100. The answer is therefore approximately 68%.
</p>

</div>

<div id="outline-container-1-3-1" class="outline-4">
<h4 id="sec-1-3-1">Normal Quantiles and the Quantile Function</h4>
<div class="outline-text-4" id="text-1-3-1">


<p>
Until now we have been given two values and our task has been to find the area under the PDF between those values. In this section, we go in reverse: we are given an area, and we would like to find the value(s) that correspond to that area. 
</p>
<p>
Assuming the IQ model of Example <a href="#exa-iq-model">iq-model</a>, what is the lowest possible IQ score that a person can have and still be in the top 1% of all IQ scores?
<i>Solution</i>: If a person is in the top 1%, then that means that 99% of the people have lower IQ scores. So, in other words, we are looking for a value \(x\) such that \(F(x)=\Pr(X\leq x)\) satisfies \(F(x)=0.99\), or yet another way to say it is that we would like to solve the equation \(F(x)-0.99=0\). For the sake of argument, let us see how to do this the long way. We define the function \(g(x)=F(x)-0.99\), and then look for the root of \(g\) with the <code>uniroot</code> function. It uses numerical procedures to find the root so we need to give it an interval of \(x\) values in which to search for the root. We can get an educated guess from the Empirical Rule <a href="#fac-Empirical-Rule">Empirical-Rule</a>; the root should be somewhere between two and three standard deviations (15 each) above the mean (which is 100).
</p>


<pre class="src src-R"><span style="color: #0000ff;">g</span> <span style="color: #008b8b;">&lt;-</span> <span style="color: #a020f0;">function</span>(x) pnorm(x, mean = 100, sd = 15) - 0.99
uniroot(g, interval = c(130, 145))
</pre>



<pre class="example">$root
[1] 134.8952153680102

$f.root
[1] -4.873082937173479e-09

$iter
[1] 6

$estim.prec
[1] 6.103515630684342e-05
</pre>




<p>
The answer is shown in <code>$root</code> which is approximately \(  134.8952 \), that is, a person with this IQ score or higher falls in the top 1% of all IQ scores.
</p>
<p>
The discussion in example <a href="#exa-iq-quantile-state-problem">iq-quantile-state-problem</a> was centered on the search for a value \(x\) that solved an equation \(F(x)=p\), for some given probability \(p\), or in mathematical parlance, the search for \(F^{-1}\), the inverse of the CDF of \(X\), evaluated at \(p\). This is so important that it merits a definition all its own.
</p>
<p>
<div class="defn">
The <i>quantile function</i>
of a random variable \(X\) is the inverse of its cumulative distribution function:
\begin{equation}
Q_{X}(p)=\min\left\{ x:\ F_{X}(x)\geq p\right\} ,\quad 0 < p <1.
\end{equation}
</div>
</p>
<p>
<div class="rem">
Here are some properties of quantile functions:
</p><ol>
<li>The quantile function is defined and finite for all \(0&lt;p&lt;1\).
</li>
<li>\(Q_{X}\) is left-continuous (see Appendix <a href="#sec-Differential-and-Integral">Differential-and-Integral</a>). For discrete random variables it is a step function, and for continuous random variables it is a continuous function.
</li>
<li>In the continuous case the graph of \(Q_{X}\) may be obtained by reflecting the graph of \(F_{X}\) about the line \(y=x\). In the discrete case, before reflecting one should: 1) connect the dots to get rid of the jumps &ndash; this will make the graph look like a set of stairs, 2) erase the horizontal lines so that only vertical lines remain, and finally 3) swap the open circles with the solid dots. Please see Figure <a href="#fig-binom-plot-distr">binom-plot-distr</a> for a comparison. 
</li>
<li>The two limits
   \[
   \lim_{p\to0^{+}}Q_{X}(p)\quad\mbox{and}\quad\lim_{p\to1^{-}}Q_{X}(p)
   \]
   always exist, but may be infinite (that is, sometimes \(\lim_{p\to0}Q(p)=-\infty\) and/or \(\lim_{p\to1}Q(p)=\infty\)).
</li>
</ol>


<p>
</div>
</p>
<p>
As the reader might expect, the standard normal distribution is a very special case and has its own special notation.
</p>
<p>
<div class="defn">
For \(0&lt;\alpha&lt;1\), the symbol \(z_{\alpha}\) denotes the unique solution of the equation \(\Pr(Z&gt;z_{\alpha})=\alpha\), where \(Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\). It can be calculated in one of two equivalent ways: <code>qnorm(</code>\(1-\alpha\)=)= and <code>qnorm(</code>\(\alpha\)=, lower.tail = FALSE)=. 
</div>
</p>
<p>
There are a few other very important special cases which we will encounter in later chapters. 
</p>


<p>
Quantile functions are defined for all of the base distributions with the <code>q</code> prefix to the distribution name, except for the ECDF whose quantile function is exactly the \( Q_{x}(p) = \mathsf{quantile}(x, \mathtt{probs} = p, \mathtt{type} = 1) \) function. 
</p>
<p>
Back to Example <a href="#exa-iq-quantile-state-problem">iq-quantile-state-problem</a>, we are looking for \(Q_{X}(0.99)\), where \(X\sim\mathsf{norm}(\mathtt{mean}=100,\,\mathtt{sd}=15)\). It could not be easier to do with \(\mathsf{R}\). 
</p>



<pre class="src src-R">qnorm(0.99, mean = 100, sd = 15)
</pre>


<pre class="example">
[1] 134.8952
[1] 134.8952181106126
</pre>


<p>
Compare this answer to the one obtained earlier with <code>uniroot</code>.
</p>
<p>
Find the values \(z_{0.025}\), \(z_{0.01}\), and \(z_{0.005}\) (these will play an important role from Chapter <a href="#cha-Estimation">Estimation</a> onward).
</p>



<pre class="src src-R">qnorm(c(0.025, 0.01, 0.005), lower.tail = <span style="color: #228b22;">FALSE</span>)
</pre>


<pre class="example">
[1] 1.959963984540054 2.326347874040841 2.575829303548900
</pre>


<p>
Note the <code>lower.tail</code> argument. We would get the same answer with
</p><pre class="example">
qnorm(c(0.975, 0.99, 0.995))
</pre>


</div>
</div>

</div>

<div id="outline-container-1-4" class="outline-3">
<h3 id="sec-1-4">Functions of Continuous Random Variables</h3>
<div class="outline-text-3" id="text-1-4">


<p>
The goal of this section is to determine the distribution of \(U=g(X)\) based on the distribution of \(X\). In the discrete case all we needed to do was back substitute for \(x=g^{-1}(u)\) in the PMF of \(X\) (sometimes accumulating probability mass along the way). In the continuous case, however, we need more sophisticated tools. Now would be a good time to review Appendix <a href="#sec-Differential-and-Integral">Differential-and-Integral</a>.
</p>

</div>

<div id="outline-container-1-4-1" class="outline-4">
<h4 id="sec-1-4-1">The PDF Method</h4>
<div class="outline-text-4" id="text-1-4-1">


<p>
<div class="prop">
</p>
<p>
Let \(X\) have PDF \(f_{X}\) and let \(g\) be a function which is one-to-one with a differentiable inverse \(g^{-1}\). Then the PDF of \(U=g(X)\) is given by
\begin{equation}
f_{U}(u)=f_{X}\left[g^{-1}(u)\right]\ \left|\frac{\mathrm{d}}{\mathrm{d} u}g^{-1}(u)\right|.\label{eq:univ-trans-pdf-long}
\end{equation}
</div>
</p>
<p>
<div class="rem">
The formula in Equation <a href="#eq-univ-trans-pdf-long">univ-trans-pdf-long</a> is nice, but does not really make any sense. It is better to write in the intuitive form
\begin{equation}
f_{U}(u)=f_{X}(x)\left|\frac{\mathrm{d} x}{\mathrm{d} u}\right|.\label{eq:univ-trans-pdf-short}
\end{equation}
</div>
</p>
<p>
Let \(X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\), and let \(Y=\mathrm{e}^{X}\). What is the PDF of \(Y\)? 
<b>Solution:</b> Notice first that \(\mathrm{e}^{x}&gt;0\) for any \(x\), so the support of \(Y\) is \((0,\infty)\). Since the transformation is monotone, we can solve \(y=\mathrm{e}^{x}\) for \(x\) to get \(x=\ln\, y\), giving \(\mathrm{d} x/\mathrm{d} y=1/y\). Therefore, for any \(y&gt;0\),
\[
f_{Y}(y)=f_{X}(\ln y)\cdot\left|\frac{1}{y}\right|=\frac{1}{\sigma\sqrt{2\pi}}\exp\left\{ \frac{(\ln y-\mu)^{2}}{2\sigma^{2}}\right\} \cdot\frac{1}{y},
\]
where we have dropped the absolute value bars since \(y&gt;0\). The random variable \(Y\) is said to have a <i>lognormal distribution</i>; see Section <a href="#sec-Other-Continuous-Distributions">Other-Continuous-Distributions</a>.
</p>
<p>
Suppose \(X\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) and let \(Y=4-3X\). What is the PDF of \(Y\)?
</p>
<p>
The support of \(X\) is \((-\infty,\infty)\), and as \(x\) goes from \(-\infty\) to \(\infty\), the quantity \(y=4-3x\) also traverses \((-\infty,\infty)\). Solving for \(x\) in the equation \(y=4-3x\) yields \(x=-(y-4)/3\) giving \(\mathrm{d} x/\mathrm{d} y=-1/3\). And since
\[
f_{X}(x)=\frac{1}{\sqrt{2\pi}}\mathrm{e}^{-x^{2}/2}, \quad -\infty < x < \infty ,
\]
we have
\begin{eqnarray*}
f_{Y}(y) & = & f_{X}\left(\frac{y-4}{3}\right)\cdot\left|-\frac{1}{3}\right|,\quad-\infty<y<\infty,\\
 & = & \frac{1}{3\sqrt{2\pi}}\mathrm{e}^{-(y-4)^{2}/2\cdot3^{2}},\quad-\infty<y<\infty.
\end{eqnarray*}
We recognize the PDF of \(Y\) to be that of a \(\mathsf{norm}(\mathtt{mean}=4,\,\mathtt{sd}=3)\) distribution. Indeed, we may use an identical argument as the above to prove the following fact:
</p>
<p>
<div class="fact">
If \(X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) and if \(Y=a+bX\) for constants \(a\) and \(b\), with \(b\neq0\), then \(Y\sim\mathsf{norm}(\mathtt{mean}=a+b\mu,\,\mathtt{sd}=|b|\sigma)\). 
</div>
</p>
<p>
Note that it is sometimes easier to <i>postpone</i> solving for the inverse transformation \(x=x(u)\). Instead, leave the transformation in the form \(u=u(x)\) and calculate the derivative of the <i>original</i> transformation
\begin{equation}
\mathrm{d} u/\mathrm{d} x=g'(x).
\end{equation}
Once this is known, we can get the PDF of \(U\) with
\begin{equation}
f_{U}(u)=f_{X}(x)\left|\frac{1}{\mathrm{d} u/\mathrm{d} x}\right|.
\end{equation}
In many cases there are cancellations and the work is shorter. Of course, it is not always true that
\begin{equation}
\frac{\mathrm{d} x}{\mathrm{d} u}=\frac{1}{\mathrm{d} u/\mathrm{d} x},\label{eq:univ-jacob-recip}
\end{equation}
but for the well-behaved examples in this book the trick works just fine.
</p>
<p>
<div class="rem">
In the case that \(g\) is not monotone we cannot apply Proposition <a href="#pro-func-cont-rvs-pdf-formula">func-cont-rvs-pdf-formula</a> directly. However, hope is not lost. Rather, we break the support of \(X\) into pieces such that \(g\) is monotone on each one. We apply Proposition <a href="#pro-func-cont-rvs-pdf-formula">func-cont-rvs-pdf-formula</a> on each piece, and finish up by adding the results together.
</div>
</p>
</div>

</div>

<div id="outline-container-1-4-2" class="outline-4">
<h4 id="sec-1-4-2">The CDF method</h4>
<div class="outline-text-4" id="text-1-4-2">


<p>
We know from Section <a href="#sec-continuous-random-variables">continuous-random-variables</a> that \(f_{X}=F_{X}'\) in the continuous case. Starting from the equation \(F_{Y}(y)=\Pr(Y\leq y)\), we may substitute \(g(X)\) for \(Y\), then solve for \(X\) to obtain \(\Pr[X\leq g^{-1}(y)]\), which is just another way to write \(F_{X}[g^{-1}(y)]\). Differentiating this last quantity with respect to \(y\) will yield the PDF of \(Y\).
</p>
<p>
Suppose \(X\sim\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)\) and
suppose that we let \(Y=-\ln\, X\). What is the PDF of \(Y\)?
</p>
<p>
The support set of \(X\) is \((0,1),\) and \(y\) traverses \((0,\infty)\) as \(x\) ranges from \(0\) to \(1\), so the support set of \(Y\) is \(S_{Y}=(0,\infty)\). For any \(y&gt;0\), we consider
\[
F_{Y}(y)=\Pr(Y\leq y)=\Pr(-\ln\, X\leq y)=\Pr(X\geq\mathrm{e}^{-y})=1-\Pr(X<\mathrm{e}^{-y}),
\]
where the next to last equality follows because the exponential function is <i>monotone</i> (this point will be revisited later). Now since \(X\) is continuous the two probabilities \(\Pr(X&lt;\mathrm{e}^{-y})\) and \(\Pr(X\leq\mathrm{e}^{-y})\) are equal; thus
\[
1-\Pr(X < \mathrm{e}^{-y})=1-\Pr(X\leq\mathrm{e}^{-y})=1-F_{X}(\mathrm{e}^{-y}).
\]
Now recalling that the CDF of a \(\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)\) random variable satisfies \(F(u)=u\) (see Equation <a href="#eq-unif-cdf">unif-cdf</a>), we can say
\[
F_{Y}(y)=1-F_{X}(\mathrm{e}^{-y})=1-\mathrm{e}^{-y},\quad\mbox{for }y>0.
\]
We have consequently found the formula for the CDF of \(Y\); to obtain the PDF \(f_{Y}\) we need only differentiate \(F_{Y}\):
\[
f_{Y}(y)=\frac{\mathrm{d}}{\mathrm{d} y}\left(1-\mathrm{e}^{-y}\right)=0-\mathrm{e}^{-y}(-1),
\]
or \(f_{Y}(y)=\mathrm{e}^{-y}\) for \(y&gt;0\). This turns out to be a member of the exponential family of distributions, see Section <a href="#sec-Other-Continuous-Distributions">Other-Continuous-Distributions</a>. 
</p>
<p>
<b>The Probability Integral Transform</b>. Given a continuous random variable \(X\) with strictly increasing CDF \(F_{X}\), let the random variable \(Y\) be defined by \(Y=F_{X}(X)\). Then the distribution of \(Y\) is \(\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)\).
</p>
<p>
<div class="proof">
We employ the CDF method. First note that the support of \(Y\) is \((0,1)\). Then for any \(0&lt;y&lt;1\),
\[
F_{Y}(y)=\Pr(Y\leq y)=\Pr(F_{X}(X)\leq y).
\]
Now since \(F_{X}\) is strictly increasing, it has a well defined inverse function \(F_{X}^{-1}\). Therefore,
\[
\Pr(F_{X}(X)\leq y)=\Pr(X\leq F_{X}^{-1}(y))=F_{X}[F_{X}^{-1}(y)]=y.
\]
Summarizing, we have seen that \(F_{Y}(y)=y\), \(0&lt;y&lt;1\). But this is exactly the CDF of a \(\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)\) random variable. 
</div>
</p>
<p>
<div class="fact">
The Probability Integral Transform is true for all continuous random variables with continuous CDFs, not just for those with strictly increasing CDFs (but the proof is more complicated). The transform is <b>not</b> true for discrete random variables, or for continuous random variables having a discrete component (that is, with jumps in their CDF).
</div>
</p>
<p>
Let \(Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) and let \(U=Z^{2}\). What is the PDF of \(U\)? 
Notice first that \(Z^{2}\geq0\), and thus the support of \(U\) is \([0,\infty)\). And for any \(u\geq0\), 
\[
F_{U}(u)=\Pr(U\leq u)=\Pr(Z^{2}\leq u).
\]
But \(Z^{2}\leq u\) occurs if and only if \(-\sqrt{u}\leq Z\leq\sqrt{u}\). The last probability above is simply the area under the standard normal PDF from \(-\sqrt{u}\) to \(\sqrt{u}\), and since \(\phi\) is symmetric about 0, we have
\[
\Pr(Z^{2}\leq u)=2\Pr(0\leq Z\leq\sqrt{u})=2\left[F_{Z}(\sqrt{u})-F_{Z}(0)\right]=2\Phi(\sqrt{u})-1,
\]
because \(\Phi(0)=1/2\). To find the PDF of \(U\) we differentiate the CDF recalling that \(\Phi'=\phi\).
\[
f_{U}(u)=\left(2\Phi(\sqrt{u})-1\right)'=2\phi(\sqrt{u})\cdot\frac{1}{2\sqrt{u}}=u^{-1/2}\phi(\sqrt{u}).
\]
Substituting,
\[
f_{U}(u)=u^{-1/2}\frac{1}{\sqrt{2\pi}}\,\mathrm{e}^{-(\sqrt{u})^{2}/2}=(2\pi u)^{-1/2}\mathrm{e}^{-u},\quad u>0.
\]
This is what we will later call a <i>chi-square distribution with 1 degree of freedom</i>. See Section <a href="#sec-Other-Continuous-Distributions">Other-Continuous-Distributions</a>.
</p>

<p>
The <code>distr</code> package has functionality to investigate transformations of univariate distributions. There are exact results for ordinary transformations of the standard distributions, and <code>distr</code> takes advantage of these in many cases. For instance, the <code>distr</code> package can handle the transformation in Example <a href="#exa-lin-trans-norm">lin-trans-norm</a> quite nicely:
</p>



<pre class="src src-R"><span style="color: #008b8b;">library</span>(distr)
X <span style="color: #008b8b;">&lt;-</span> Norm(mean = 0, sd = 1)
Y <span style="color: #008b8b;">&lt;-</span> 4 - 3*X
Y
</pre>


<pre class="example">
 Distribution Object of Class: Norm
 mean: 4
 sd: 3
</pre>


<p>
So <code>distr</code> ``knows'' that a linear transformation of a normal random variable is again normal, and it even knows what the correct <code>mean</code> and <code>sd</code> should be. But it is impossible for <code>distr</code> to know everything, and it is not long before we venture outside of the transformations that <code>distr</code> recognizes. Let us try Example <a href="#exa-lnorm-transformation">lnorm-transformation</a>:
</p>



<pre class="src src-R">Y <span style="color: #008b8b;">&lt;-</span> exp(X)
Y
</pre>


<pre class="example">
Distribution Object of Class: AbscontDistribution
</pre>


<p>
The result is an object of class <code>AbscontDistribution</code>, which is one of the classes that <code>distr</code> uses to denote general distributions that it does not recognize (it turns out that \(Z\) has a <i>lognormal</i> distribution; see Section <a href="#sec-Other-Continuous-Distributions">Other-Continuous-Distributions</a>). A simplified description of the process that <code>distr</code> undergoes when it encounters a transformation \(Y=g(X)\) that it does not recognize is
</p><ol>
<li>Randomly generate many, many copies \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) from the distribution of \(X\),
</li>
<li>Compute \(Y_{1}=g(X_{1})\), \(Y_{2}=g(X_{2})\), &hellip;, \(Y_{n}=g(X_{n})\) and store them for use.
</li>
<li>Calculate the PDF, CDF, quantiles, and random variates using the simulated values of \(Y\).
</li>
</ol>

<p>As long as the transformation is sufficiently nice, such as a linear transformation, the exponential, absolute value, <i>etc.</i>, the \texttt{d-p-q} functions are calculated analytically based on the d-p-q functions associated with \(X\). But if we try a crazy transformation then we are greeted by a warning:
</p>



<pre class="src src-R">W <span style="color: #008b8b;">&lt;-</span> sin(exp(X) + 27)
W
</pre>


<pre class="example">
Distribution Object of Class: AbscontDistribution
</pre>


<p>
The warning confirms that the \texttt{d-p-q} functions are not calculated analytically, but are instead based on the randomly simulated values of \(Y\). <i>We must be careful to remember this.</i> The nature of random simulation means that we can get different answers to the same question: watch what happens when we compute \(\Pr(W\leq0.5)\) using the \(W\) above, then define \(W\) again, and compute the (supposedly) same \(\Pr(W\leq0.5)\) a few moments later.
</p>



<pre class="src src-R">p(W)(0.5)
W <span style="color: #008b8b;">&lt;-</span> sin(exp(X) + 27)
p(W)(0.5)
</pre>


<pre class="example">
[1] 0.5793242067579324
[1] 0.5793242067579324
</pre>


<p>
The answers are not the same! Furthermore, if we were to repeat the process we would get yet another answer for \(\Pr(W\leq0.5)\).  
</p>
<p>
The answers were close, though. And the underlying randomly generated \(X\)'s were not the same so it should hardly be a surprise that the calculated \(W\)'s were not the same, either. This serves as a warning (in concert with the one that <code>distr</code> provides) that we should be careful to remember that complicated transformations computed by \(\mathsf{R}\) are only approximate and may fluctuate slightly due to the nature of the way the estimates are calculated.
</p>
</div>
</div>

</div>

<div id="outline-container-1-5" class="outline-3">
<h3 id="sec-1-5">Other Continuous Distributions</h3>
<div class="outline-text-3" id="text-1-5">



</div>

<div id="outline-container-1-5-1" class="outline-4">
<h4 id="sec-1-5-1">Waiting Time Distributions</h4>
<div class="outline-text-4" id="text-1-5-1">


<p>
In some experiments, the random variable being measured is the time until a certain event occurs. For example, a quality control specialist may be testing a manufactured product to see how long it takes until it fails. An efficiency expert may be recording the customer traffic at a retail store to streamline scheduling of staff. 
</p>

<p>
We say that \(X\) has an <i>exponential distribution</i> and write \(X\sim\mathsf{exp}(\mathtt{rate}=\lambda)\). 
\begin{equation}
f_{X}(x)=\lambda\mathrm{e}^{-\lambda x},\quad x>0
\end{equation}
The associated \(\mathsf{R}\) functions are <code>dexp(x, rate = 1)</code>, <code>pexp</code>, <code>qexp</code>, and <code>rexp</code>, which give the PDF, CDF, quantile function, and simulate random variates, respectively.
</p>
<p>
The parameter \(\lambda\) measures the rate of arrivals (to be described later) and must be positive. The CDF is given by the formula
\begin{equation}
F_{X}(t)=1-\mathrm{e}^{-\lambda t},\quad t>0.
\end{equation}
The mean is \(\mu=1/\lambda\) and the variance is \(\sigma^{2}=1/\lambda^{2}\). 
</p>
<p>
The exponential distribution is closely related to the Poisson distribution. If customers arrive at a store according to a Poisson process with rate \(\lambda\) and if \(Y\) counts the number of customers that arrive in the time interval \([0,t)\), then we saw in Section <a href="#sec-other-discrete-distributions">other-discrete-distributions</a> that \( Y \sim \mathsf{pois}(\mathtt{lambda}=\lambda t). \) Now consider a different question: let us start our clock at time 0 and stop the clock when the first customer arrives. Let \(X\) be the length of this random time interval. Then \(X\sim\mathsf{exp}(\mathtt{rate}=\lambda)\). Observe the following string of equalities:
\begin{align*}
\Pr(X>t) & =\Pr(\mbox{first arrival after time \emph{t}}),\\
 & =\Pr(\mbox{no events in [0,\emph{t})}),\\
 & =\Pr(Y=0),\\
 & =\mathrm{e}^{-\lambda t},
\end{align*}
where the last line is the PMF of \(Y\) evaluated at \(y=0\). In other words, \(\Pr(X\leq t)=1-\mathrm{e}^{-\lambda t}\), which is exactly the CDF of an \(\mathsf{exp}(\mathtt{rate}=\lambda)\) distribution. 
</p>
<p>
The exponential distribution is said to be <i>memoryless</i> because exponential random variables "forget" how old they are at every instant. That is, the probability that we must wait an additional five hours for a customer to arrive, given that we have already waited seven hours, is exactly the probability that we needed to wait five hours for a customer in the first place. In mathematical symbols, for any \(s,\, t&gt;0\),
\begin{equation}
\Pr(X>s+t\,|\, X>t)=\Pr(X>s).
\end{equation}
See Exercise <a href="#xca-prove-the-memoryless">prove-the-memoryless</a>.
</p>
</div>

</div>

<div id="outline-container-1-5-2" class="outline-4">
<h4 id="sec-1-5-2">The Gamma Distribution</h4>
<div class="outline-text-4" id="text-1-5-2">


<p>
This is a generalization of the exponential distribution. We say that \(X\) has a gamma distribution and write \(X\sim\mathsf{gamma}(\mathtt{shape}=\alpha,\,\mathtt{rate}=\lambda)\). It has PDF
\begin{equation}
f_{X}(x)=\frac{\lambda^{\alpha}}{\Gamma(\alpha)}\: x^{\alpha-1}\mathrm{e}^{-\lambda x},\quad x>0.
\end{equation}

The associated \(\mathsf{R}\) functions are <code>dgamma(x, shape, rate = 1)</code>, <code>pgamma</code>, <code>qgamma</code>, and <code>rgamma</code>, which give the PDF, CDF, quantile function, and simulate random variates, respectively. If \(\alpha=1\) then \(X\sim\mathsf{exp}(\mathtt{rate}=\lambda)\). The mean is \(\mu=\alpha/\lambda\) and the variance is \(\sigma^{2}=\alpha/\lambda^{2}\).
</p>
<p>
To motivate the gamma distribution recall that if \(X\) measures the length of time until the first event occurs in a Poisson process with rate \(\lambda\) then \(X\sim\mathsf{exp}(\mathtt{rate}=\lambda)\). If we let \(Y\) measure the length of time until the \(\alpha^{\mathrm{th}}\) event occurs then \(Y\sim\mathsf{gamma}(\mathtt{shape}=\alpha,\,\mathtt{rate}=\lambda)\). When \(\alpha\) is an integer this distribution is also known as the <i>Erlang</i> distribution.
</p>
<p>
At a car wash, two customers arrive per hour on the average. We decide to measure how long it takes until the third customer arrives. If \(Y\) denotes this random time then \(Y\sim\mathsf{gamma}(\mathtt{shape}=3,\,\mathtt{rate}=1/2)\).
</p>
</div>

</div>

<div id="outline-container-1-5-3" class="outline-4">
<h4 id="sec-1-5-3">The Chi square, Student's \(t\), and Snedecor's \(F\) Distributions</h4>
<div class="outline-text-4" id="text-1-5-3">



<p>
A random variable \(X\) with PDF
\begin{equation}
f_{X}(x)=\frac{1}{\Gamma(p/2)2^{p/2}}x^{p/2-1}\mathrm{e}^{-x/2},\quad x>0,
\end{equation}
is said to have a <i>chi-square distribution</i> with \(p\) <i>degrees of freedom</i>. We write \(X\sim\mathsf{chisq}(\mathtt{df}=p)\). The associated \(\mathsf{R}\) functions are <code>dchisq(x, df)</code>, <code>pchisq</code>, <code>qchisq</code>, and <code>rchisq</code>, which give the PDF, CDF, quantile function, and simulate random variates, respectively. See Figure <a href="#fig-chisq-dist-vary-df">chisq-dist-vary-df</a>. In an obvious notation we may define \(\chi_{\alpha}^{2}(p)\) as the number on the \(x\)-axis such that there is exactly \(\alpha\) area under the \(\mathsf{chisq}(\mathtt{df}=p)\) curve to its right.
</p>
<p>
The code to produce Figure <a href="#fig-chisq-dist-vary-df">chisq-dist-vary-df</a> is
</p>



<pre class="src src-R">curve(dchisq(x, df = 3), from = 0, to = 20, ylab = <span style="color: #8b2252;">"y"</span>)
ind <span style="color: #008b8b;">&lt;-</span> c(4, 5, 10, 15)
<span style="color: #a020f0;">for</span> (i <span style="color: #a020f0;">in</span> ind) curve(dchisq(x, df = i), 0, 20, add = <span style="color: #228b22;">TRUE</span>)
</pre>







<div id="fig-chisq-dist-vary-df" class="figure">
  <p><img src="svg/chisq-dist-vary-df.svg" width=500 alt="svg/chisq-dist-vary-df.svg" /></p>
  <p>The chi square distribution for various degrees of freedom.</p>
</div>

<p>
<div class="rem">
Here are some useful things to know about the chi-square distribution.
</p><ol>
<li>If \(Z\sim\mathtt{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\), then \(Z^{2}\sim\mathsf{chisq}(\mathtt{df}=1)\). We saw this in Example <a href="#exa-distn-of-z-squared">distn-of-z-squared</a>, and the fact is important when it comes time to find the distribution of the sample variance, \(S^{2}\). See Theorem <a href="#thm-Xbar-andS">Xbar-andS</a> in Section <a href="#sub-Samp-Var-Dist">Samp-Var-Dist</a>.
</li>
<li>The chi-square distribution is supported on the positive \(x\)-axis, with a right-skewed distribution.
</li>
<li>The \(\mathsf{chisq}(\mathtt{df}=p)\) distribution is the same as a \(\mathsf{gamma}(\mathtt{shape}=p/2,\,\mathtt{rate}=1/2)\) distribution. 
</li>
<li>The MGF of \(X\sim\mathsf{chisq}(\mathtt{df}=p)\) is
   \begin{equation}
   M_{X}(t)=\left(1-2t\right)^{-p},\quad t<1/2.\label{eq:mgf-chisq}
   \end{equation}
</li>
</ol>


<p>
</div>
</p>
</div>

</div>

<div id="outline-container-1-5-4" class="outline-4">
<h4 id="sec-1-5-4">Student's \(t\) distribution</h4>
<div class="outline-text-4" id="text-1-5-4">


<p>
A random variable \(X\) with PDF
\begin{equation}
f_{X}(x)=\frac{\Gamma\left[(r+1)/2\right]}{\sqrt{r\pi}\,\Gamma(r/2)}\left(1+\frac{x^{2}}{r}\right)^{-(r+1)/2},\quad-\infty<x<\infty
\end{equation}
is said to have <i>Student's</i> \(t\) distribution with \(r\) <i>degrees of freedom</i>, and we write \(X\sim\mathsf{t}(\mathtt{df}=r)\). The associated \(\mathsf{R}\) functions are <code>dt</code>,=pt=, <code>qt</code>, and <code>rt</code>, which give the PDF, CDF, quantile function, and simulate random variates, respectively. See Section <a href="#sec-sampling-from-normal-dist">sampling-from-normal-dist</a>.
</p>
</div>

</div>

<div id="outline-container-1-5-5" class="outline-4">
<h4 id="sec-1-5-5">Snedecor's \(F\) distribution</h4>
<div class="outline-text-4" id="text-1-5-5">


<p>
A random variable \(X\) with PDF
\begin{equation}
f_{X}(x)=\frac{\Gamma[(m+n)/2]}{\Gamma(m/2)\Gamma(n/2)}\left(\frac{m}{n}\right)^{m/2}x^{m/2-1}\left(1+\frac{m}{n}x\right)^{-(m+n)/2},\quad x>0.
\end{equation}
is said to have an \(F\) distribution with \((m,n)\) degrees of freedom. We write \(X\sim\mathsf{f}(\mathtt{df1}=m,\,\mathtt{df2}=n)\). The associated \(\mathsf{R}\) functions are <code>df(x, df1, df2)</code>, <code>pf</code>, <code>qf</code>, and <code>rf</code>, which give the PDF, CDF, quantile function, and simulate random variates, respectively. We define \(F_{\alpha}(m,n)\) as the number on the \(x\)-axis such that there is exactly \(\alpha\) area under the \(\mathsf{f}(\mathtt{df1}=m,\,\mathtt{df2}=n)\) curve to its right. 
</p>
<p>
<div class="rem">
Here are some notes about the \(F\) distribution.
</p><ol>
<li>If \(X\sim\mathsf{f}(\mathtt{df1}=m,\,\mathtt{df2}=n)\) and \(Y=1/X\), then \(Y\sim\mathsf{f}(\mathtt{df1}=n,\,\mathtt{df2}=m)\). Historically, this fact was especially convenient. In the old days, statisticians used printed tables for their statistical calculations. Since the \(F\) tables were symmetric in \(m\) and \(n\), it meant that publishers could cut the size of their printed tables in half. It plays less of a role today now that personal computers are widespread.
</li>
<li>If \(X\sim\mathsf{t}(\mathtt{df}=r)\), then \(X^{2}\sim\mathsf{f}(\mathtt{df1}=1,\,\mathtt{df2}=r)\). We will see this again in Section <a href="#sub-slr-overall-F-statistic">slr-overall-F-statistic</a>.
</li>
</ol>


<p>
</div>
</p>
</div>

</div>

<div id="outline-container-1-5-6" class="outline-4">
<h4 id="sec-1-5-6">Other Popular Distributions</h4>
<div class="outline-text-4" id="text-1-5-6">



<p>
This is a special case of the Student's \(t\) distribution. It has PDF
\begin{equation}
f_{X}(x)=\frac{1}{\beta\pi}\left[1+\left(\frac{x-m}{\beta}\right)^{2}\right]^{-1},\quad-\infty<x<\infty.
\end{equation}
We write \(X\sim\mathsf{cauchy}(\mathtt{location}=m,\,\mathtt{scale}=\beta)\). The associated \(\mathsf{R}\) function is <code>dcauchy(x, location = 0, scale = 1)</code>.
</p>
<p>
It is easy to see that a \(\mathsf{cauchy}(\mathtt{location}=0,\,\mathtt{scale}=1)\) distribution is the same as a \(\mathsf{t}(\mathtt{df}=1)\) distribution. The \(\mathsf{cauchy}\) distribution looks like a \(\mathsf{norm}\) distribution but with very heavy tails. The mean (and variance) do not exist, that is, they are infinite. The median is represented by the \(\mathtt{location}\) parameter, and the \(\mathtt{scale}\) parameter influences the spread of the distribution about its median.
</p>

<p>
This is a generalization of the continuous uniform distribution.
\begin{equation}
f_{X}(x)=\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}\: x^{\alpha-1}(1-x)^{\beta-1},\quad0<x<1
\end{equation}
We write \(X\sim\mathsf{beta}(\mathtt{shape1}=\alpha,\,\mathtt{shape2}=\beta)\). The associated \(\mathsf{R}\) function is <code>dbeta(x, shape1, shape2)</code>. The mean and variance are
\begin{equation} 
\mu=\frac{\alpha}{\alpha+\beta}\mbox{ and }\sigma^{2}=\frac{\alpha\beta}{\left(\alpha+\beta\right)^{2}\left(\alpha+\beta+1\right)}.
\end{equation}
See Example <a href="#exa-cont-pdf3x2">cont-pdf3x2</a>. This distribution comes up a lot in Bayesian statistics because it is a good model for one's prior beliefs about a population proportion \(p\), \(0\leq p\leq1\).
</p>




\begin{equation}
f_{X}(x)=\frac{1}{\sigma}\exp\left(-\frac{x-\mu}{\sigma}\right)\left[1+\exp\left(-\frac{x-\mu}{\sigma}\right)\right]^{-2},\quad-\infty<x<\infty.
\end{equation}
<p>
We write \(X\sim\mathsf{logis}(\mathtt{location}=\mu,\,\mathtt{scale}=\sigma)\). The associated \(\mathsf{R}\) function is <code>dlogis(x, location = 0, scale = 1)</code>. The logistic distribution comes up in differential equations as a model for population growth under certain assumptions. The mean is \(\mu\) and the variance is \(\pi^{2}\sigma^{2}/3\).
</p>

<p>
This is a distribution derived from the normal distribution (hence the name). If \(U\sim\mathtt{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\), then \( X = \mathrm{e}^{U} \) has PDF
\begin{equation}
f_{X}(x)=\frac{1}{\sigma x\sqrt{2\pi}}\exp\left[\frac{-(\ln x-\mu)^{2}}{2\sigma^{2}}\right],\quad0<x<\infty.
\end{equation}
We write \(X\sim\mathsf{lnorm}(\mathtt{meanlog}=\mu,\,\mathtt{sdlog}=\sigma)\). The associated \(\mathsf{R}\) function is <code>dlnorm(x, meanlog = 0, sdlog = 1)</code>. Notice that the support is concentrated on the positive \(x\) axis; the distribution is right-skewed with a heavy tail. See Example <a href="#exa-lnorm-transformation">lnorm-transformation</a>.
</p>


<p>
This has PDF
\begin{equation}
f_{X}(x)=\frac{\alpha}{\beta}\left(\frac{x}{\beta}\right)^{\alpha-1}\exp\left(\frac{x}{\beta}\right)^{\alpha},\quad x>0.
\end{equation}
We write \(X\sim\mathsf{weibull}(\mathtt{shape}=\alpha,\,\mathtt{scale}=\beta)\). The associated \(\mathsf{R}\) function is <code>dweibull(x, shape, scale = 1)</code>. 
</p>


<p>
There is some support of moments and moment generating functions for some continuous probability distributions included in the <code>actuar</code> package \cite{Dutangactuar}. The convention is <code>m</code> in front of the distribution name for raw moments, and <code>mgf</code> in front of the distribution name for the moment generating function. At the time of this writing, the following distributions are supported: gamma, inverse Gaussian, (non-central) chi-squared, exponential, and uniform.
</p>
<p>
Calculate the first four raw moments for \(X\sim\mathsf{gamma}(\mathtt{shape}=13,\,\mathtt{rate}=1)\) and plot the moment generating function.
</p>
<p>
We load the <code>actuar</code> package and use the functions <code>mgamma</code> and <code>mgfgamma</code>:
</p>


<pre class="src src-R"><span style="color: #008b8b;">library</span>(actuar)
mgamma(1:4, shape = 13, rate = 1)
</pre>


<pre class="example">
X11cairo 
       2
[1]    13   182  2730 43680
</pre>


<p>
For the plot we can use the function in the following form:
</p>



<pre class="src src-R">plot(<span style="color: #a020f0;">function</span>(x){mgfgamma(x, shape = 13, rate = 1)}, from=-0.1, to=0.1, ylab = <span style="color: #8b2252;">"gamma mgf"</span>)
</pre>







<div id="fig-gamma-mgf" class="figure">
  <p><img src="svg/gamma-mgf.svg" width=500 alt="svg/gamma-mgf.svg" /></p>
  <p>A plot of the <code>gamma(shape = 13, rate = 1)</code> MGF.</p>
</div>



</div>
</div>

</div>

<div id="outline-container-1-6" class="outline-3">
<h3 id="sec-1-6">Exercises</h3>
<div class="outline-text-3" id="text-1-6">


<p>
<div class="xca">
Find the constant \(c\) so that the given function is a valid PDF of a random variable \(X\).
</p><ol>
<li>\( f(x) = Cx^{n},\quad 0 &lt; x &lt;1 \).
</li>
<li>\( f(x) = Cx\mathrm{e}^{-x},\quad 0 &lt; x &lt; \infty\).
</li>
<li>\( f(x) = \mathrm{e}^{-(x - C)}, \quad 7 &lt; x &lt; \infty.\)
</li>
<li>\( f(x) = Cx^{3}(1 - x)^{2},\quad 0 &lt; x &lt; 1.\)
</li>
<li>\( f(x) = C(1 + x^{2}/4)^{-1}, \quad -\infty &lt; x &lt; \infty.\)
</li>
</ol>


<p>
</div>
</p>
<p>
<div class="xca">
For the following random experiments, decide what the distribution of \(X\) should be. In nearly every case, there are additional assumptions that should be made for the distribution to apply; identify those assumptions (which may or may not strictly hold in practice).
</p><ol>
<li>We throw a dart at a dart board. Let \(X\) denote the squared linear distance from the bulls-eye to the where the dart landed.
</li>
<li>We randomly choose a textbook from the shelf at the bookstore and let \(P\) denote the proportion of the total pages of the book devoted to exercises. 
</li>
<li>We measure the time it takes for the water to completely drain out of the kitchen sink.
</li>
<li>We randomly sample strangers at the grocery store and ask them how long it will take them to drive home. 
</li>
</ol>


<p>
</div>
</p>
<p>
<div class="xca">
If \(Z\) is \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\), find 
</p><ol>
<li>\(\Pr(Z&gt;2.64)\)



<pre class="src src-R">   pnorm(2.64, lower.tail = <span style="color: #228b22;">FALSE</span>)
</pre>


</li>
<li>\(\Pr(0\leq Z&lt;0.87)\)



<pre class="src src-R">   pnorm(0.87) - 1/2
</pre>


</li>
<li>\(\Pr(|Z|&gt;1.39)\) (Hint: draw a picture!)



<pre class="src src-R">   2 * pnorm(-1.39)
</pre>

</li>
</ol>


<p>
</div>
</p>
<p>
<div class="xca">
Calculate the variance of \(X\sim\mathsf{unif}(\mathtt{min}=a,\,\mathtt{max}=b)\). <i>Hint:</i> First calculate \(\mathbb{E} X^{2}\).
</div>
</p>
<p>
<div class="xca">
Prove the memoryless property for exponential random variables. That is, for \(X\sim\mathsf{exp}(\mathtt{rate}=\lambda)\) show that for any \(s,t&gt;0\),
\[
\Pr(X>s+t\,|\, X>t)=\Pr(X>s).
\]
</div>
</p></div>
</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2011-09-21 17:20:31 EDT</p>
<p class="author">Author: G. Jay Kerns</p>
<p class="creator">Org version 7.7 with Emacs version 23</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
