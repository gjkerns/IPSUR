<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
lang="en" xml:lang="en">
<head>
<title>Estimation</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2011-09-21 18:23:32 EDT"/>
<meta name="author" content="G. Jay Kerns"/>
<meta name="description" content="This chapter deals with point and interval estimation in the one and two parameter setting."/>
<meta name="keywords" content="point interval estimation confidence unbiased"/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up" style="text-align:right;font-size:70%;white-space:nowrap;">
 <a accesskey="h" href="index.html   "> UP </a>
 |
 <a accesskey="H" href="http://ipsur.org/index.html"> HOME </a>
</div>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">Estimation</h1>




---
layout: chapter
title: Estimation
previous: sampling-distributions.html
next: hypothesis-testing.html
description: This chapter deals with point and interval estimation in the one and two parameter setting.
keywords:  point interval estimation confidence unbiased
---


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Estimation</a>
<ul>
<li><a href="#sec-1-1">Point Estimation</a></li>
<li><a href="#sec-1-2">Confidence Intervals for Means</a></li>
<li><a href="#sec-1-3">Confidence Intervals for Differences of Means</a></li>
<li><a href="#sec-1-4">Confidence Intervals for Proportions</a></li>
<li><a href="#sec-1-5">Confidence Intervals for Variances</a></li>
<li><a href="#sec-1-6">Fitting Distributions</a></li>
<li><a href="#sec-1-7">Sample Size and Margin of Error</a></li>
<li><a href="#sec-1-8">Other Topics</a></li>
<li><a href="#sec-1-9">Exercises</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">Estimation</h2>
<div class="outline-text-2" id="text-1">


<p>
We will discuss two branches of estimation procedures: point estimation and interval estimation. We briefly discuss point estimation first and then spend the rest of the chapter on interval estimation.
</p>
<p>
We find an estimator with the methods of Section <a href="#sec-Point-Estimation-1">Point-Estimation-1</a>. We make some assumptions about the underlying population distribution and use what we know from Chapter <a href="#cha-Sampling-Distributions">Sampling-Distributions</a> about sampling distributions both to study how the estimator will perform, and to find intervals of confidence for underlying parameters associated with the population distribution. Once we have confidence intervals we can do inference in the form of hypothesis tests in the next chapter.
</p>
<ul>
<li>how to look at a problem, identify a reasonable model, and estimate a parameter associated with the model
</li>
<li>about maximum likelihood, and in particular, how to
<ul>
<li>eyeball a likelihood to get a maximum
</li>
<li>use calculus to find an MLE for one-parameter families
</li>
</ul>

</li>
<li>about properties of the estimators they find, such as bias, minimum variance, MSE
</li>
<li>point versus interval estimation, and how to find and interpret confidence intervals for basic experimental designs
</li>
<li>the concept of margin of error and its relationship to sample size
</li>
</ul>



</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1">Point Estimation</h3>
<div class="outline-text-3" id="text-1-1">


<p>
The following example is how I was introduced to maximum likelihood.
</p>
<p>
Suppose we have a small pond in our backyard, and in the pond there live some fish. We would like to know how many fish live in the pond. How can we estimate this? One procedure developed by researchers is the capture-recapture method. Here is how it works.
</p>
<p>
We will fish from the pond and suppose that we capture \(M=7\) fish. On each caught fish we attach an unobtrusive tag to the fish's tail, and release it back into the water. 
</p>
<p>
Next, we wait a few days for the fish to remix and become accustomed to their new tag. Then we go fishing again. On the second trip some of the fish we catch may be tagged; some may not be. Let \(X\) denote the number of caught fish which are tagged
and suppose for the sake of argument that we catch \(K=4\) fish and we find that 3 of them are tagged.
</p>
<p>
Now let \(F\) denote the (unknown) total number of fish in the pond. We know that \(F\geq7\), because we tagged that many on the first trip. In fact, if we let \(N\) denote the number of untagged fish in the pond, then \(F=M+N\). We have sampled \(K=4\) times, without replacement, from an urn which has \(M=7\) white balls and \(N=F-M\) black balls, and we have observed \(x=3\) of them to be white. What is the probability of this?
</p>
<p>
Looking back to Section <a href="#sec-other-discrete-distributions">other-discrete-distributions</a>, we see that the random variable \(X\) has a \(\mathsf{hyper}(\mathtt{m}=M,\,\mathtt{n}=F-M,\,\mathtt{k}=K)\) distribution. Therefore, for an observed value \(X=x\) the probability would be
\[
\Pr(X=x)=\frac{{M \choose x}{F-M \choose K-x}}{{F \choose K}}.
\]
First we notice that \(F\) must be at least 7. Could \(F\) be equal to seven? If \(F=7\) then all of the fish would have been tagged on the first run, and there would be no untagged fish in the pond, thus, \(\Pr(\mbox{3 successes in 4 trials})=0\). 
What about \(F=8\); what would be the probability of observing \(X=3\) tagged fish?
\[
\Pr(\mbox{3 successes in 4 trials})=\frac{{7 \choose 3}{1 \choose 1}}{{8 \choose 4}}=\frac{35}{70}=0.5.
\]
Similarly, if \(F=9\) then the probability of observing \(X=3\) tagged fish would be
\[
\Pr(\mbox{3 successes in 4 trials})=\frac{{7 \choose 3}{2 \choose 1}}{{9 \choose 4}}=\frac{70}{126}\approx0.556.
\]
We can see already that the observed data \(X=3\) is more likely when \(F=9\) than it is when \(F=8\). And here lies the genius of Sir Ronald Aylmer Fisher: he asks, ``What is the value of \(F\) which has the highest likelihood?'' In other words, for all of the different possible values of \(F\), which one makes the above probability the biggest? We can answer this question with a plot of \(\Pr(X=x)\) versus \(F\). See Figure <a href="#fig-capture-recapture">capture-recapture</a>.
</p>









<div id="fig-capture-recapture" class="figure">
  <p><img src="svg/capture-recapture.svg" width=500 alt="svg/capture-recapture.svg" /></p>
  <p>A plot of maximum likelihood for the capture-recapture experiment.</p>
</div>

<p>
In the last example we were only concerned with how many fish were in the pond, but now, we will ask a different question. Suppose it is known that there are only two species of fish in the pond: smallmouth bass (<i>Micropterus dolomieu</i>) and bluegill (<i>Lepomis macrochirus</i>); perhaps we built the pond some years ago and stocked it with only these two species. We would like to estimate the proportion of fish in the pond which are bass.
</p>
<p>
Let \(p=\mbox{the proportion of bass}\). Without any other information, it is conceivable for \(p\) to be any value in the interval \([0,1]\), but for the sake of argument we will suppose that \(p\) falls strictly between zero and one. How can we learn about the true value of \(p\)? Go fishing! As before, we will use catch-and-release, but unlike before, we will not tag the fish. We will simply note the species of any caught fish before returning it to the pond. 
</p>
<p>
Suppose we catch \(n\) fish. Let
\[
X_{i}=
\begin{cases}
1, & \mbox{if the \mbox{i}\mbox{th} fish is a bass,}\\
0, & \mbox{if the \mbox{i}\mbox{th} fish is a bluegill.}
\end{cases}
\]
Since we are returning the fish to the pond once caught, we may think of this as a sampling scheme with replacement where the proportion of bass \(p\) does not change. Given that we allow the fish sufficient time to ``mix'' once returned, it is not completely unreasonable to model our fishing experiment as a sequence of Bernoulli trials, so that the \(X_{i}\)'s would be IID \(\mathsf{binom(\mathtt{size}}=1,\,\mathtt{prob}=p)\). Under those assumptions we would have
\begin{eqnarray*}
\Pr(X_{1}=x_{1},\, X_{2}=x_{2},\,\ldots,\, X_{n}=x_{n}) & = & \Pr(X_{1}=x_{1})\,\Pr(X_{2}=x_{2})\,\cdots\Pr(X_{n}=x_{n}),\\
 & = & p^{x_{1}}(1-p)^{x_{1}}\, p^{x_{2}}(1-p)^{x_{2}}\cdots\, p^{x_{n}}(1-p)^{x_{n}},\\
 & = & p^{\sum x_{i}}(1-p)^{n-\sum x_{i}}.
\end{eqnarray*}
That is, 
\[
\Pr(X_{1}=x_{1},\, X_{2}=x_{2},\,\ldots,\, X_{n}=x_{n})=p^{\sum x_{i}}(1-p)^{n-\sum x_{i}}.
\]
This last quantity is a function of \(p\), called the <i>likelihood function</i> \(L(p)\):
\[
L(p)=p^{\sum x_{i}}(1-p)^{n-\sum x_{i}}.
\]
A graph of \(L\) for values of \(\sum x_{i}=3,\ 4\), and 5 when \(n=7\) is shown in Figure <a href="#fig-fishing-part-two">fishing-part-two</a>. 
</p>



<pre class="src src-R">curve(x^5*(1-x)^2, 0, 1, xlab = <span style="color: #8b2252;">"p"</span>, ylab = <span style="color: #8b2252;">"L(p)"</span>)
curve(x^4*(1-x)^3, 0, 1, add = <span style="color: #228b22;">TRUE</span>)
curve(x^3*(1-x)^4, 0, 1, add = <span style="color: #228b22;">TRUE</span>)
</pre>







<div id="fig-fishing-part-two" class="figure">
  <p><img src="svg/fishing-part-two.svg" width=500 alt="svg/fishing-part-two.svg" /></p>
  <p>Assorted likelihood functions for fishing, part two.</p>
</div>

<p>
We want the value of \(p\) which has the highest likelihood, that is, we again wish to maximize the likelihood. We know from calculus (see Appendix <a href="#sec-Differential-and-Integral">Differential-and-Integral</a>) to differentiate \(L\) and set \(L'=0\) to find a maximum.
\[
L'(p)=\left(\sum x_{i}\right)p^{\sum x_{i}-1}(1-p)^{n-\sum x_{i}}+p^{\sum x_{i}}\left(n-\sum x_{i}\right)(1-p)^{n-\sum x_{i}-1}(-1).
\]
The derivative vanishes (\(L'=0\)) when
\begin{eqnarray*}
\left(\sum x_{i}\right)p^{\sum x_{i}-1}(1-p)^{n-\sum x_{i}} & = & p^{\sum x_{i}}\left(n-\sum x_{i}\right)(1-p)^{n-\sum x_{i}-1},\\
\sum x_{i}(1-p) & = & \left(n-\sum x_{i}\right)p,\\
\sum x_{i}-p\sum x_{i} & = & np-p\sum x_{i},\\
\frac{1}{n}\sum_{i=1}^{n}x_{i} & = & p.
\end{eqnarray*}
This ``best'' \(p\), the one which maximizes the likelihood, is called the maximum likelihood estimator (MLE) of \(p\) and is denoted \(\hat{p}\). That is, 
\begin{equation} 
\hat{p}=\frac{\sum_{i=1}^{n}x_{i}}{n}=\overline{x}.
\end{equation}

<div class="rem">
Strictly speaking we have only shown that the derivative equals zero at \(\hat{p}\), so it is theoretically possible that the critical value \(\hat{p}=\overline{x}\) is located at a minimum
instead of a maximum! We should be thorough and check that \(L'&gt;0\) when \(p&lt;\overline{x}\) and \(L'&lt;0\) when \(p&gt;\overline{x}\). Then by the First Derivative Test (Theorem <a href="#thm-First-Derivative-Test">First-Derivative-Test</a>) we could be certain that \(\hat{p}=\overline{x}\) is indeed a maximum likelihood estimator, and not a minimum likelihood estimator.
</div>
</p>
<p>
The result is shown in Figure <a href="#fig-species-mle">species-mle</a>.
</p>









<div id="fig-species-mle" class="figure">
  <p><img src="svg/species-mle.svg" width=500 alt="svg/species-mle.svg" /></p>
  <p>Species maximum likelihood.</p>
</div>

<p>
In general, we have a family of PDFs \(f(x|\theta)\) indexed by a parameter \(\theta\) in some parameter space \(\Theta\). We want to learn about \(\theta\). We take a \(SRS(n)\):
\begin{equation}
X_{1},\, X_{2},\,\ldots,X_{n}\mbox{ which are IID \( f(x| \theta ) \).}
\end{equation}

<div class="defn">
Given the observed data \(x_{1}\), \(x_{2}\), &hellip;, \(x_{n}\), the <i>likelihood function</i> \(L\) is defined by 
\[ 
L(\theta)=\prod_{i=1}^{n}f(x_{i}|\theta),\quad\theta\in\Theta.
\]
</div>
</p>
<p>
The next step is to maximize \(L\). The method we will use in this book is to find the derivative \(L'\) and solve the equation \(L'(\theta)=0\). Call a solution \(\hat{\theta}\). We will check that \(L\) is maximized at \(\hat{\theta}\) using the First Derivative Test or the Second Derivative Test \(\left(L''(\hat{\theta})&lt;0\right)\).
</p>
<p>
<div class="defn">
A value \(\theta\) that maximizes \(L\) is called a <i>maximum likelihood estimator</i> (MLE) and is denoted \(\hat{\theta}\). It is a function of the sample, \(\hat{\theta}=\hat{\theta}\left(X_{1},\, X_{2},\,\ldots,X_{n}\right)\), and is called a <i>point estimator</i> of \(\theta\).
</div>
</p>
<p>
<div class="rem">
Some comments about maximum likelihood estimators:
</p><ul>
<li>Often it is easier to maximize the <i>log-likelihood</i> \(l(\theta)=\ln L(\theta)\) instead of the likelihood \(L\). Since the logarithmic function \(y=\ln x\) is a monotone transformation, the solutions to both problems are the same.
</li>
<li>MLEs do not always exist (for instance, sometimes the likelihood has a vertical asymptote), and even when they do exist, they are not always unique (imagine a function with a bunch of humps of equal height). For any given problem, there could be zero, one, or any number of values of \(\theta\) for which \(L(\theta)\) is a maximum.
</li>
<li>The problems we encounter in this book are all very nice with likelihood functions that have closed form representations and which are optimized by some calculus acrobatics. In practice, however, likelihood functions are sometimes nasty in which case we are obliged to use numerical methods to find maxima (if there are any).
</li>
<li>MLEs are just one of <span style="text-decoration:underline;">many</span> possible estimators. One of the more popular alternatives are the <i>method of moments estimators</i>; see Casella and Berger \cite{Casella2002} for more.
</li>
</ul>


<p>
</div>
</p>
<p>
Notice, in Example <a href="#exa-bass-bluegill">bass-bluegill</a> we had \(X_{i}\) IID \(\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)\), and we saw that the MLE was \(\hat{p}=\overline{X}\). But further
\begin{eqnarray*}
\mathbb{E}\overline{X} & = & \mathbb{E}\frac{X_{1}+X_{2}+\cdots+X_{n}}{n},\\
 & = & \frac{1}{n}\left(\mathbb{E} X_{1}+\mathbb{E} X_{2}+\cdots+\mathbb{E} X_{n}\right),\\
 & = & \frac{1}{n}\left(np\right),\\
 & = & p,
\end{eqnarray*}
which is exactly the same as the parameter which we estimated. More concisely, \(\mathbb{E}\hat{p}=p\), that is, on the average, the estimator is exactly right.
</p>
<p>
<div class="defn">
Let \(s(X_{1},X_{2},\ldots,X_{n})\) be a statistic which estimates \(\theta\). If 
\[
\mathbb{E} s(X_{1},X_{2},\ldots,X_{n})=\theta,
\]
then the statistic \(s(X_{1},X_{2},\ldots,X_{n})\) is said to be an <i>unbiased estimator</i> of \(\theta\). Otherwise, it is <i>biased</i>.
</div>
</p>

<p>
Let \(X_{1}\), \(X_{2}\), &hellip; , \(X_{n}\) be an \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution. It can be shown (in Exercise <a href="#xca-norm-mu-sig-MLE">norm-mu-sig-MLE</a>) that if \(\mbox{$\theta$}=(\mu,\sigma^{2})\) then the MLE of \(\theta\) is
\begin{equation}
\hat{\theta}=(\hat{\mu},\hat{\sigma}^{2}),
\end{equation}
where \(\hat{\mu}=\overline{X}\) and
\begin{equation}
\hat{\sigma^{2}}=\frac{1}{n}\sum_{i=1}^{n}\left(X_{i}-\overline{X}\right)^{2}=\frac{n-1}{n}S^{2}.
\end{equation}
We of course know from <a href="#pro-mean-sd-xbar">mean-sd-xbar</a> that \(\hat{\mu}\) is unbiased. What about \(\hat{\sigma^{2}}\)? Let us check: 
\begin{eqnarray*}
\mathbb{E}\,\hat{\sigma^{2}} & = & \mathbb{E}\,\frac{n-1}{n}S^{2}\\
 & = & \mathbb{E}\left(\frac{\sigma^{2}}{n}\frac{(n-1)S^{2}}{\sigma^{2}}\right)\\
 & = & \frac{\sigma^{2}}{n}\mathbb{E}\ \mathsf{chisq}(\mathtt{df}=n-1)\\
 & = & \frac{\sigma^{2}}{n}(n-1),
\end{eqnarray*}
from which we may conclude two things:
</p><ul>
<li>\(\hat{\sigma^{2}}\) is a biased estimator of \(\sigma^{2}\), and 
</li>
<li>\(S^{2}=n\hat{\sigma^{2}}/(n-1)\) is an unbiased estimator of \(\sigma^{2}\).
</li>
</ul>



<p>
One of the most common questions in an introductory statistics class is, ``Why do we divide by \(n-1\) when we compute the sample variance? Why do we not divide by \(n\)?'' We see now that division by \(n\) amounts to the use of a <i>biased</i> estimator for \(\sigma^{2}\), that is, if we divided by \(n\) then on the average we would <i>underestimate</i> the true value of \(\sigma^{2}\). We use \(n-1\) so that, on the average, our estimator of \(\sigma^{2}\) will be exactly right. 
</p>


<p>
\(\mathsf{R}\) can be used to find maximum likelihood estimators in a lot of diverse settings. We will discuss only the most basic here and will leave the rest to more sophisticated texts.
</p>
<p>
For one parameter estimation problems we may use the <code>optimize</code> function to find MLEs. The arguments are the function to be maximized (the likelihood function), the range over which the optimization is to take place, and optionally any other arguments to be passed to the likelihood if needed.
</p>
<p>
Let us see how to do Example <a href="#exa-bass-bluegill">bass-bluegill</a>. Recall that our likelihood function was given by
\begin{equation}
L(p)=p^{\sum x_{i}}(1-p)^{n-\sum x_{i}}.
\end{equation}
Notice that the likelihood is just a product of \(\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)\) PMFs. We first give some sample data (in the vector <code>datavals</code>), next we define the likelihood function <code>L</code>, and finally we <code>optimize</code> <code>L</code> over the range <code>c(0,1)</code>.
</p>



<pre class="src src-R">x <span style="color: #008b8b;">&lt;-</span> mtcars$am
<span style="color: #0000ff;">L</span> <span style="color: #008b8b;">&lt;-</span> <span style="color: #a020f0;">function</span>(p,x) prod(dbinom(x, size = 1, prob = p))
optimize(L, interval = c(0,1), x = x, maximum = <span style="color: #228b22;">TRUE</span>)
</pre>


<pre class="example">
X11cairo 
       2
 $maximum
[1] 0.4062458

$objective
[1] 4.099989e-10
</pre>




<p>
Note that the <code>optimize</code> function by default minimizes the function <code>L</code>, so we have to set <code>maximum = TRUE</code> to get an MLE. The returned value of <code>$maximum</code> gives an approximate value of the MLE to be \(  0.406 \) and <code>objective</code> gives <code>L</code> evaluated at the MLE which is approximately \(  0 \).
</p>
<p>
We previously remarked that it is usually more numerically convenient to maximize the log-likelihood (or minimize the negative log-likelihood), and we can just as easily do this with \(\mathsf{R}\). We just need to calculate the log-likelihood beforehand which (for this example) is
\[
-l(p)=-\sum x_{i}\ln\, p-\left(n-\sum x_{i}\right)\ln(1-p).
\]

It is done in \(\mathsf{R}\) with
</p>



<pre class="src src-R"><span style="color: #0000ff;">minuslogL</span> <span style="color: #008b8b;">&lt;-</span> <span style="color: #a020f0;">function</span>(p,x){
                -sum(dbinom(x, size = 1, prob = p, log = <span style="color: #228b22;">TRUE</span>))
             }
optimize(minuslogL, interval = c(0,1), x = x)
</pre>


<pre class="example">
[1] 0.406
[1] 0
 $minimum
[1] 0.4062525

$objective
[1] 21.61487
</pre>


<p>
Note that we did not need <code>maximum = TRUE</code> because we minimized the negative log-likelihood. The answer for the MLE is essentially the same as before, but the <code>$objective</code> value was different, of course.
</p>
<p>
For multiparameter problems we may use a similar approach by way of the <code>mle</code> function in the <code>stats4</code> package. 
</p>

<p>
<b>Plant Growth.</b> We will investigate the <code>weight</code> variable of the <code>PlantGrowth</code> data. We will suppose that the weights constitute a random observations \(X_{1}\), \(X_{2}\), &hellip; , \(X_{n}\) that are IID \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) which is not unreasonable based on a histogram and other exploratory measures. We will find the MLE of \(\theta=(\mu,\sigma^{2})\). We claimed in Example <a href="#exa-normal-MLE-both">normal-MLE-both</a> that \(\hat{\theta}=(\hat{\mu},\hat{\sigma}^{2})\) had the form given above. Let us check whether this is plausible numerically. The negative log-likelihood function is
</p>



<pre class="src src-R"><span style="color: #0000ff;">minuslogL</span> <span style="color: #008b8b;">&lt;-</span> <span style="color: #a020f0;">function</span>(mu, sigma2){
  -sum(dnorm(x, mean = mu, sd = sqrt(sigma2), log = <span style="color: #228b22;">TRUE</span>))
}
</pre>


<p>
Note that we omitted the data as an argument to the log-likelihood function; the only arguments were the parameters over which the maximization is to take place. Now we will simulate some data and find the MLE. The optimization algorithm requires starting values (intelligent guesses) for the parameters. We choose values close to the sample mean and variance (which turn out to be approximately 5 and 0.5, respectively) to illustrate the procedure.
</p>



<pre class="src src-R">x <span style="color: #008b8b;">&lt;-</span> PlantGrowth$weight
<span style="color: #008b8b;">library</span>(stats4)
MaxLikeEst <span style="color: #008b8b;">&lt;-</span> mle(minuslogL, start = list(mu = 5, sigma2 = 0.5))
summary(MaxLikeEst)
</pre>



<pre class="example"> Maximum likelihood estimation

Call:
mle(minuslogl = minuslogL, start = list(mu = 5, sigma2 = 0.5))

Coefficients:
        Estimate Std. Error
mu     5.0729848  0.1258666
sigma2 0.4752721  0.1227108

-2 log L: 62.82084
</pre>


<p>
The outputted MLEs are shown above, and <code>mle</code> even gives us estimates for the standard errors of \(\hat{\mu}\) and \(\hat{\sigma}^{2}\) (which were obtained by inverting the numerical Hessian matrix at the optima; see Appendix <a href="#sec-Multivariable-Calculus">Multivariable-Calculus</a>). Let us check how close the numerical MLEs came to the theoretical MLEs:
</p>



<pre class="src src-R">mean(x); var(x)*29/30; sd(x)/sqrt(30)
</pre>


<pre class="example">
[1] 5.073
[1] 0.475281
[1] 0.1280195
</pre>


<p>
The numerical MLEs were very close to the theoretical MLEs. We already knew that the standard error of \(\hat{\mu}=\overline{X}\) is \(\sigma/\sqrt{n}\), and the numerical estimate of this was very close too.
</p>

<p>
There is functionality in the <code>distrTest</code> package \cite{Ruckdescheldistr} to calculate theoretical MLEs; we will skip examples of these for the time being.
</p>
</div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2">Confidence Intervals for Means</h3>
<div class="outline-text-3" id="text-1-2">


<p>
We are given \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) that are an \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution, where \(\mu\) is unknown. We know that we may estimate \(\mu\) with \(\overline{X}\), and we have seen that this estimator is the MLE. But how good is our estimate? We know that 
\begin{equation} 
\frac{\overline{X}-\mu}{\sigma/\sqrt{n}}\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1).
\end{equation}
For a big probability \(1-\alpha\), for instance, 95%, we can calculate the quantile \(z_{\alpha/2}\). Then
\begin{equation}
\Pr\left(-z_{\alpha/2}\leq\frac{\overline{X}-\mu}{\sigma/\sqrt{n}}\leq z_{\alpha/2}\right)=1-\alpha.
\end{equation}
But now consider the following string of equivalent inequalities:
\[
-z_{\alpha/2}\leq\frac{\overline{X}-\mu}{\sigma/\sqrt{n}}\leq z_{\alpha/2},
\]
\[
-z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right)\leq\overline{X}-\mu\leq z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right),
\]
\[
-\overline{X}-z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right)\leq-\mu\leq-\overline{X}+z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right),
\]
\[
\overline{X}-z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right)\leq\mu\leq\overline{X}+z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right).
\]
That is, 
\begin{equation}
\Pr\left(\overline{X}-z_{\alpha/2}\frac{\sigma}{\sqrt{n}}\leq\mu\leq\overline{X}+z_{\alpha/2}\frac{\sigma}{\sqrt{n}}\right)=1-\alpha.
\end{equation}

<div class="defn">
The interval
\begin{equation}
\left[\overline{X}-z_{\alpha/2}\frac{\sigma}{\sqrt{n}},\ \overline{X}+z_{\alpha/2}\frac{\sigma}{\sqrt{n}}\right]
\end{equation}
is a \(100(1-\alpha)\%\) <i>confidence interval for</i> \(\mu\). The quantity \(1-\alpha\) is called the <i>confidence coefficient</i>.
</div>
</p>
<p>
<div class="rem">
The interval is also sometimes written more compactly as
\begin{equation}
\overline{X}\pm z_{\alpha/2}\frac{\sigma}{\sqrt{n}}.\label{eq:z-interval}
\end{equation}
</div>
</p>
<p>
The interpretation of confidence intervals is tricky and often mistaken by novices. When I am teaching the concept ``live'' during class, I usually ask the students to imagine that my piece of chalk represents the ``unknown'' parameter, and I lay it down on the desk in front of me. Once the chalk has been lain, it is <i>fixed</i>; it does not move. Our goal is to estimate the parameter. For the estimator I pick up a sheet of loose paper lying nearby. The estimation procedure is to randomly drop the piece of paper from above, and observe where it lands. If the piece of paper covers the piece of chalk, then we are successful &ndash; our estimator covers the parameter. If it falls off to one side or the other, then we are unsuccessful; our interval fails to cover the parameter.
</p>
<p>
Then I ask them: suppose we were to repeat this procedure hundreds, thousands, millions of times. Suppose we kept track of how many times we covered and how many times we did not. What percentage of the time would we be successful?
</p>
<p>
In the demonstration, the parameter corresponds to the chalk, the sheet of paper corresponds to the confidence interval, and the random experiment corresponds to dropping the sheet of paper. The percentage of the time that we are successful <i>exactly</i> corresponds to the <i>confidence coefficient</i>. That is, if we use a 95% confidence interval, then we can say that, in the long run, approximately 95% of our intervals will cover the true parameter (which is fixed, but unknown). 
</p>
<p>
See Figure <a href="#fig-ci-examp">ci-examp</a>, which is a graphical display of these ideas.
</p>



<pre class="src src-R"><span style="color: #008b8b;">library</span>(TeachingDemos)
ci.examp()
</pre>







<div id="fig-ci-examp" class="figure">
  <p><img src="svg/ci-examp.svg" width=500 alt="svg/ci-examp.svg" /></p>
  <p>Simulated confidence intervals.</p>
</div>

<p>
Under the above framework, we can reason that an ``interval'' with a <i>larger</i> confidence coefficient corresponds to a <i>wider</i> sheet of paper. Furthermore, the width of the confidence interval (sheet of paper) should be <i>somehow</i> related to the amount of information contained in the random sample, \(X_{1}\), \(X_{2}\), &hellip;,
\(X_{n}\). The following remarks makes these notions precise. 
</p>
<p>
<div class="rem">
For a fixed confidence coefficient \(1-\alpha\),
\begin{equation}
\mbox{if }n\mbox{ increases, then the confidence interval gets \emph{SHORTER}.}
\end{equation}
</div>
</p>
<p>
<div class="rem">
For a fixed sample size \(n\),
\begin{equation}
\mbox{if }1-\alpha\mbox{ increases, then the confidence interval gets \emph{WIDER}.}
\end{equation}
</div>
</p>

<p>
<b>Results from an Experiment on Plant Growth.</b> The <code>PlantGrowth</code> data frame gives the results of an experiment to measure plant yield (as measured by the weight of the plant). We would like to a 95% confidence interval for the mean weight of the plants. Suppose that we know from prior research that the true population standard deviation of the plant weights is \(0.7\) g.
</p>
<p>
The parameter of interest is \(\mu\), which represents the true mean weight of the population of all plants of the particular species in the study. We will first take a look at a stemplot of the data:
</p>




<pre class="src src-R"><span style="color: #008b8b;">library</span>(aplpack)
with(PlantGrowth, stem.leaf(weight))
</pre>



<pre class="example">X11cairo 
       2
1 | 2: represents 1.2
 leaf unit: 0.1
            n: 30
   1     f | 5
         s | 
   2    3. | 8
   4    4* | 11
   5     t | 3
   8     f | 455
  10     s | 66
  13    4. | 889
  (4)   5* | 1111
  13     t | 2233
   9     f | 555
         s | 
   6    5. | 88
   4    6* | 011
   1     t | 3
</pre>


<p>
The data appear to be approximately normal with no extreme values. The data come from a designed experiment, so it is reasonable to suppose that the observations constitute a simple random sample of weights
We know the population standard deviation \(\sigma=0.70\) from prior research. We are going to use the one-sample \(z\)-interval.
</p>



<pre class="src src-R">dim(PlantGrowth)   <span style="color: #b22222;"># </span><span style="color: #b22222;">sample size is first entry</span>
</pre>


<pre class="example">
[1] 30  2
</pre>





<pre class="src src-R">with(PlantGrowth, mean(weight))
</pre>


<pre class="example">
[1] 5.073
</pre>





<pre class="src src-R">qnorm(0.975)
</pre>


<pre class="example">
[1] 1.959964
</pre>


<p>
We find the sample mean of the data to be \(\overline{x}=5.073\) and \(z_{\alpha/2}=z_{0.025}\approx1.96\). Our interval is therefore
\[
\overline{x}\pm z_{\alpha/2}\frac{\sigma}{\sqrt{n}}=5.073\pm1.96\cdot\frac{0.70}{\sqrt{30}},
\]
which comes out to approximately \([4.823,\,5.323]\). In conclusion, we are 95% confident that the true mean weight \(\mu\) of all plants of this species lies somewhere between 4.823 g and 5.323 g, that is, we are 95% confident that the interval \([4.823,\,5.323]\) covers \(\mu\).
</p>
<p>
Give some data with \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) an \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution. Maybe small sample?
</p>
<ol>
<li>What is the parameter of interest? in the context of the problem.
</li>
<li>Give a point estimate for \(\mu\).
</li>
<li>What are the assumptions being made in the problem? Do they meet the conditions of the interval?
</li>
<li>Calculate the interval.
</li>
<li>Draw the conclusion.
</li>
</ol>


<p>
<div class="rem">
What if \(\sigma\) is unknown? We instead use the interval
\begin{equation}
\overline{X}\pm z_{\alpha/2}\frac{S}{\sqrt{n}},
\end{equation}
where \(S\) is the sample standard deviation.
</p><ul>
<li>If \(n\) is large, then \(\overline{X}\) will have an approximately normal distribution regardless of the underlying population (by the CLT) and \(S\) will be very close to the parameter \(\sigma\) (by the SLLN); thus the above interval will have approximately \(100(1-\alpha)\%\) confidence of covering \(\mu\).
</li>
<li>If \(n\) is small, then
<ul>
<li>If the underlying population is normal then we may replace \(z_{\alpha/2}\) with \(t_{\alpha/2}(\mathtt{df}=n-1)\). The resulting \(100(1-\alpha)\%\) confidence interval is
     \begin{equation}
     \overline{X}\pm t_{\alpha/2}(\mathtt{df}=n-1)\frac{S}{\sqrt{n}}.\label{eq:one-samp-t-int}
     \end{equation}
</li>
<li>if the underlying population is not normal, but approximately normal, then we may use the \(t\) interval, Equation <a href="#eq-one-samp-t-int">one-samp-t-int</a>. The interval will have approximately \(100(1-\alpha)\%\) confidence of covering \(\mu\). However, if the population is highly skewed or the data have outliers, then we should ask a professional statistician for advice.
</li>
</ul>

</li>
</ul>


<p>
</div>
</p>
<p>
The author learned of a handy acronym from AP Statistics Exam graders that summarizes the important parts of confidence interval estimation, which is PANIC: \emph{P}arameter, \emph{A}ssumptions, \emph{N}ame, \emph{I}nterval, and \emph{C}onclusion.
</p><dl>
<dt>Parameter:</dt><dd>identify the parameter of interest with the proper symbols. Write down what the parameter means in the context of the problem.
</dd>
<dt>Assumptions:</dt><dd>list any assumptions made in the experiment. If there are any other assumptions needed or that were not checked, state what they are and why they are important.
</dd>
<dt>Name:</dt><dd>choose a statistical procedure from your bag of tricks based on the answers to the previous two parts. The assumptions of the procedure you choose should match those of the problem; if they do not match then either pick a different procedure or openly admit that the results may not be reliable. Write down any underlying formulas used.
</dd>
<dt>Interval:</dt><dd>calculate the interval from the sample data. This can be done by hand but will more often be done with the aid of a computer. Regardless of the method, all calculations or code should be shown so that the entire process is repeatable by a subsequent reader.
</dd>
<dt>Conclusion:</dt><dd>state the final results, using language in the context of the problem. Include the appropriate interpretation of the interval, making reference to the confidence coefficient.
</dd>
</dl>


<p>
<div class="rem">
All of the above intervals for \(\mu\) were two-sided, but there are also one-sided intervals for \(\mu\). They look like
\begin{equation}
\left[\overline{X}-z_{\alpha}\frac{\sigma}{\sqrt{n}},\ \infty\right)\quad\mbox{or}\quad\left(-\infty,\ \overline{X}+z_{\alpha}\frac{\sigma}{\sqrt{n}}\right]
\end{equation}
and satisfy
\begin{equation}
\Pr\left(\overline{X}-z_{\alpha}\frac{\sigma}{\sqrt{n}}\leq\mu\right)=1-\alpha\quad\mbox{and}\quad\Pr\left(\overline{X}+z_{\alpha}\frac{\sigma}{\sqrt{n}}\geq\mu\right)=1-\alpha.
\end{equation}
</div>
</p>

<p>
Small sample, some data with \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) an \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution.  PANIC
</p>
<p>
We can do Example <a href="#exa-plant-one-samp-z-int">plant-one-samp-z-int</a> with the following code.
</p>




<pre class="src src-R"><span style="color: #008b8b;">library</span>(TeachingDemos)
temp <span style="color: #008b8b;">&lt;-</span> with(PlantGrowth, z.test(weight, stdev = 0.7))
temp
</pre>



<pre class="example"> 
	One Sample z-test

data:  weight 
z = 39.6942, n = 30.000, Std. Dev. = 0.700, Std. Dev.
of the sample mean = 0.128, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0 
95 percent confidence interval:
 4.822513 5.323487 
sample estimates:
mean of weight 
         5.073
</pre>


<p>
The confidence interval bounds are shown in the sixth line down of the output (please disregard all of the additional output information for now &ndash; we will use it in Chapter <a href="#cha-Hypothesis-Testing">Hypothesis-Testing</a>). We can make the plot for Figure <a href="#fig-plant-z-int-plot">plant-z-int-plot</a> with
</p>



<pre class="src src-R"><span style="color: #008b8b;">library</span>(IPSUR)
plot(temp, <span style="color: #8b2252;">"Conf"</span>)
</pre>


</div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3">Confidence Intervals for Differences of Means</h3>
<div class="outline-text-3" id="text-1-3">


<p>
Let \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) be a \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu_{X},\,\mathtt{sd}=\sigma_{X})\) distribution and let \(Y_{1}\), \(Y_{2}\), &hellip;, \(Y_{m}\) be a \(SRS(m)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu_{Y},\,\mathtt{sd}=\sigma_{Y})\) distribution. Further, assume that the \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) sample is independent of the \(Y_{1}\), \(Y_{2}\), &hellip;, \(Y_{m}\) sample.
</p>
<p>
Suppose that \(\sigma_{X}\) and \(\sigma_{Y}\) are known. We would like a confidence interval for \(\mu_{X}-\mu_{Y}\). We know that 
\begin{equation}
\overline{X}-\overline{Y}\sim\mathsf{norm}\left(\mathtt{mean}=\mu_{X}-\mu_{Y},\,\mathtt{sd}=\sqrt{\frac{\sigma_{X}^{2}}{n}+\frac{\sigma_{Y}^{2}}{m}}\right).
\end{equation}
Therefore, a \( 100(1-\alpha)\% \) confidence interval for \(\mu_{X}-\mu_{Y}\) is given by
\begin{equation}
\left(\overline{X}-\overline{Y}\right)\pm z_{\alpha/2}\sqrt{\frac{\sigma_{X}^{2}}{n}+\frac{\sigma_{Y}^{2}}{m}}.\label{eq:two-samp-mean-CI}
\end{equation}
Unfortunately, most of the time the values of \(\sigma_{X}\) and \(\sigma_{Y}\) are unknown. This leads us to the following:
</p><ul>
<li>If both sample sizes are large, then we may appeal to the CLT/SLLN (see <a href="#sec-Central-Limit-Theorem">Central-Limit-Theorem</a>) and substitute \(S_{X}^{2}\) and \(S_{Y}^{2}\) for \(\sigma_{X}^{2}\) and \(\sigma_{Y}^{2}\) in the interval <a href="#eq-two-samp-mean-CI">two-samp-mean-CI</a>. The resulting confidence interval will have approximately \(100(1-\alpha)\%\) confidence.
</li>
<li>If one or more of the sample sizes is small then we are in trouble, unless
    -the underlying populations are both normal and \(\sigma_{X}=\sigma_{Y}\). In this case (setting \(\sigma=\sigma_{X}=\sigma_{Y}\)), 
    \begin{equation}
    \overline{X}-\overline{Y}\sim\mathsf{norm}\left(\mathtt{mean}=\mu_{X}-\mu_{Y},\,\mathtt{sd}=\sigma\sqrt{\frac{1}{n}+\frac{1}{m}}\right).
    \end{equation}
</li>
</ul>

<p>Now let
\begin{equation}
U=\frac{n-1}{\sigma^{2}}S_{X}^{2}+\frac{m-1}{\sigma^{2}}S_{Y}^{2}.
\end{equation}
Then by Exercise <a href="#xca-sum-indep-chisq">sum-indep-chisq</a> we know that \(U\sim\mathsf{chisq}(\mathtt{df}=n+m-2)\) and is not a large leap to believe that \(U\) is independent of \(\overline{X}-\overline{Y}\); thus
\begin{equation}
T=\frac{Z}{\sqrt{\left.U\right\slash (n+m-2)}}\sim\mathsf{t}(\mathtt{df}=n+m-2).
\end{equation}
But
\begin{align*}
T & =\frac{\frac{\overline{X}-\overline{Y}-(\mu_{X}-\mu_{Y})}{\sigma\sqrt{\frac{1}{n}+\frac{1}{m}}}}{\sqrt{\left.\frac{n-1}{\sigma^{2}}S_{X}^{2}+\frac{m-1}{\sigma^{2}}S_{Y}^{2}\right\slash (n+m-2)}},\\
 & =\frac{\overline{X}-\overline{Y}-(\mu_{X}-\mu_{Y})}{\sqrt{\left(\frac{1}{n}+\frac{1}{m}\right)\left(\frac{(n-1)S_{X}^{2}+(m-1)S_{Y}^{2}}{n+m-2}\right)}},\\
 & \sim\mathsf{t}(\mathtt{df}=n+m-2).
\end{align*}
Therefore a \(100(1-\alpha)\%\) confidence interval for \(\mu_{X}-\mu_{Y}\) is given by
\begin{equation}
\left(\overline{X}-\overline{Y}\right)\pm t_{\alpha/2}(\mathtt{df}=n+m-2)\, S_{p}\sqrt{\frac{1}{n}+\frac{1}{m}},
\end{equation}
where
\begin{equation}
S_{p}=\sqrt{\frac{(n-1)S_{X}^{2}+(m-1)S_{Y}^{2}}{n+m-2}}
\end{equation}
is called the ``pooled'' estimator of \(\sigma\).
</p><ul>
<li>If one of the samples is small, and both underlying populations are normal, but \(\sigma_{X}\neq\sigma_{Y}\), then we may use a Welch (or Satterthwaite) approximation to the degrees of freedom. See Welch \cite{Welch1947}, Satterthwaite \cite{Satterthwaite1946}, or Neter <i>et al</i> \cite{Neter1996}. The idea is to use an interval of the form 
</li>
</ul>


\begin{equation}
\left(\overline{X}-\overline{Y}\right)\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=r)\,\sqrt{\frac{S_{X}^{2}}{n}+\frac{S_{Y}^{2}}{m}},
\end{equation}
<p>
where the degrees of freedom \(r\) is chosen so that the interval has nice statistical properties. It turns out that a good choice for \(r\) is given by
\begin{equation}
r=\frac{\left(S_{X}^{2}/n+S_{Y}^{2}/m\right)^{2}}{\frac{1}{n-1}\left(S_{X}^{2}/n\right)^{2}+\frac{1}{m-1}\left(S_{Y}^{2}/m\right)^{2}},
\end{equation}
where we understand that \(r\) is rounded down to the nearest integer. The resulting interval has approximately \(100(1-\alpha)\%\) confidence.
</p>

<p>
The basic function is <code>t.test</code> which has a <code>var.equal</code> argument that may be set to <code>TRUE</code> or <code>FALSE</code>. The confidence interval is shown as part of the output, although there is a lot of additional information that is not needed until Chapter
<a href="#cha-Hypothesis-Testing">Hypothesis-Testing</a>.
</p>
<p>
There is not any specific functionality to handle the \(z\)-interval for small samples, but if the samples are large then <code>t.test</code> with <code>var.equal = FALSE</code> will be essentially the same thing. The standard deviations are never (?) known in advance anyway so it does not really matter in practice. 
</p>
</div>

</div>

<div id="outline-container-1-4" class="outline-3">
<h3 id="sec-1-4">Confidence Intervals for Proportions</h3>
<div class="outline-text-3" id="text-1-4">


<p>
We would like to know \(p\) which is the ``proportion of successes''. For instance, \(p\) could be:
</p><ul>
<li>the proportion of U.S. citizens that support Obama,
</li>
<li>the proportion of smokers among adults age 18 or over,
</li>
<li>the proportion of people worldwide infected by the H1N1 virus.
</li>
</ul>


<p>
We are given an \(SRS(n)\) \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) distributed \(\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)\). Recall from Section <a href="#sec-binom-dist">binom-dist</a> that the common mean of these variables is \(\mathbb{E} X=p\) and the variance is \(\mathbb{E}(X-p)^{2}=p(1-p)\). If we let \(Y=\sum X_{i}\), then from Section <a href="#sec-binom-dist">binom-dist</a> we know that \(Y\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)\) and that 
\[
\overline{X}=\frac{Y}{n}\mbox{ has }\mathbb{E}\overline{X}=p\mbox{ and }\mathrm{Var}(\overline{X})=\frac{p(1-p)}{n}.
\]
Thus if \(n\) is large (here is the CLT) then an approximate \(100(1-\alpha)\%\) confidence interval for \(p\) would be given by
\begin{equation}
\overline{X}\pm z_{\alpha/2}\sqrt{\frac{p(1-p)}{n}}.\label{eq:ci-p-no-good}
\end{equation}
OOPS&hellip;! Equation <a href="#eq-ci-p-no-good">ci-p-no-good</a> is of no use to us because the \underbar{unknown} parameter \(p\) is in the formula! (If we knew what \(p\) was to plug in the formula then we would not need a confidence interval in the first place.) There are two solutions to this problem.
</p><ol>
<li>Replace \(p\) with \(\hat{p}=\overline{X}\). Then an approximate \(100(1-\alpha)\%\) confidence interval for \(p\) is given by 
   \begin{equation}
   \hat{p}\pm z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}.
   \end{equation}
   This approach is called the <i>Wald interval</i> and is also known as the <i>asymptotic interval</i> because it appeals to the CLT for large sample sizes.
</li>
<li>Go back to first principles. Note that
   \[
   -z_{\alpha/2}\leq\frac{Y/n-p}{\sqrt{p(1-p)/n}}\leq z_{\alpha/2}
   \]
   exactly when the function \(f\) defined by
   \[
   f(p)=\left(Y/n-p\right)^{2}-z_{\alpha/2}^{2}\frac{p(1-p)}{n}
   \]
   satisfies \(f(p)\leq0\). But \(f\) is quadratic in \(p\) so its graph is a parabola; it has two roots, and these roots form the limits of the confidence interval. We can find them with the quadratic formula (see Exercise <a href="#xca-CI-quad-form">CI-quad-form</a>):
   \begin{equation}
   \left.\left[\left(\hat{p}+\frac{z_{\alpha/2}^{2}}{2n}\right)\pm z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}+\frac{z_{\alpha/2}^{2}}{(2n)^{2}}}\right]\right\slash \left(1+\frac{z_{\alpha/2}^{2}}{n}\right)
   \end{equation}
   This approach is called the <i>score interval</i> because it is based on the inversion of the ``Score test''. See Chapter <a href="#cha-Categorical-Data-Analysis">Categorical-Data-Analysis</a>. It is also known as the <i>Wilson interval</i>; see Agresti \cite{Agresti2002}.
</li>
</ol>



<p>
For two proportions \(p_{1}\) and \(p_{2}\), we may collect independent \(\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)\) samples of size \(n_{1}\) and \(n_{2}\), respectively. Let \(Y_{1}\) and \(Y_{2}\) denote the number of successes in the respective samples. 
We know that
\[
\frac{Y_{1}}{n_{1}}\approx\mathsf{norm}\left(\mathtt{mean}=p_{1},\,\mathtt{sd}=\sqrt{\frac{p_{1}(1-p_{1})}{n_{1}}}\right)
\]
and
\[
\frac{Y_{2}}{n_{2}}\approx\mathsf{norm}\left(\mathtt{mean}=p_{2},\,\mathtt{sd}=\sqrt{\frac{p_{2}(1-p_{2})}{n_{2}}}\right)
\]
so it stands to reason that an approximate \(100(1-\alpha)\%\) confidence interval for \(p_{1}-p_{2}\) is given by
\begin{equation}
\left(\hat{p}_{1}-\hat{p}_{2}\right)\pm z_{\alpha/2}\sqrt{\frac{\hat{p}_{1}(1-\hat{p}_{1})}{n_{1}}+\frac{\hat{p}_{2}(1-\hat{p}_{2})}{n_{2}}},
\end{equation}
where \(\hat{p}_{1}=Y_{1}/n_{1}\) and \(\hat{p}_{2}=Y_{2}/n_{2}\).
</p>
<p>
<div class="rem">
When estimating a single proportion, one-sided intervals are sometimes needed. They take the form
\begin{equation}
\left[0,\ \hat{p}+z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}\right]
\end{equation}
or
\begin{equation}
\left[\hat{p}-z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}},\ 1\right]
\end{equation}
or in other words, we know in advance that the true proportion is restricted to the interval \([0,1]\), so we can truncate our confidence interval to those values on either side.
</div>
</p>





<pre class="src src-R"><span style="color: #008b8b;">library</span>(Hmisc)
binconf(x = 7, n = 25, method = <span style="color: #8b2252;">"asymptotic"</span>)
</pre>


<pre class="example">
 PointEst     Lower     Upper
     0.28 0.1039957 0.4560043
</pre>





<pre class="src src-R">binconf(x = 7, n = 25, method = <span style="color: #8b2252;">"wilson"</span>)
</pre>


<pre class="example">
 PointEst     Lower     Upper
     0.28 0.1428385 0.4757661
</pre>


<p>
The default value of the <code>method</code> argument is <code>wilson</code>.  An alternate way is 
</p>




<pre class="src src-R">tab <span style="color: #008b8b;">&lt;-</span> xtabs(~gender, data = RcmdrTestDrive)
prop.test(rbind(tab), conf.level = 0.95, correct = <span style="color: #228b22;">FALSE</span>)
</pre>



<pre class="example"> 
	1-sample proportions test without continuity
	correction

data:  rbind(tab), null probability 0.5 
X-squared = 4.6667, df = 1, p-value = 0.03075
alternative hypothesis: true p is not equal to 0.5 
95 percent confidence interval:
 0.3447942 0.4922649 
sample estimates:
        p 
0.4166667
</pre>



<pre class="src src-R">A <span style="color: #008b8b;">&lt;-</span> as.data.frame(Titanic)
<span style="color: #008b8b;">library</span>(reshape)
B <span style="color: #008b8b;">&lt;-</span> with(A, untable(A, Freq))
</pre>


</div>

</div>

<div id="outline-container-1-5" class="outline-3">
<h3 id="sec-1-5">Confidence Intervals for Variances</h3>
<div class="outline-text-3" id="text-1-5">


<p>
I am thinking one and two sample problems here.
</p>

<p>
I am thinking about <code>sigma.test</code> in the <code>TeachingDemos</code> package and <code>var.test</code> in base \(\mathsf{R}\) here.
</p>
</div>

</div>

<div id="outline-container-1-6" class="outline-3">
<h3 id="sec-1-6">Fitting Distributions</h3>
<div class="outline-text-3" id="text-1-6">




<p>
I am thinking about <code>fitdistr</code> from the <code>MASS</code> package \cite{Venables2002}.
</p>
</div>

</div>

<div id="outline-container-1-7" class="outline-3">
<h3 id="sec-1-7">Sample Size and Margin of Error</h3>
<div class="outline-text-3" id="text-1-7">


<p>
Sections <a href="#sec-Confidence-Intervals-for-Means">Confidence-Intervals-for-Means</a> through <a href="#sec-Confidence-Intervals-for-Variances">Confidence-Intervals-for-Variances</a> all began the same way: we were given the sample size \(n\) and the confidence coefficient \(1-\alpha\), and our task was to find a margin of error \(E\) so that 
\[
\hat{\theta}\pm E\mbox{ is a }100(1-\alpha)\%\mbox{ confidence interval for }\theta.
\]

Some examples we saw were:
</p><ul>
<li>\(E=z_{\alpha/2}\sigma/\sqrt{n}\), in the one-sample \(z\)-interval,
</li>
<li>\(E=t_{\alpha/2}(\mathtt{df}=n+m-2)S_{p}\sqrt{n^{-1}+m^{-1}}\), in the two-sample pooled \(t\)-interval. 
</li>
</ul>


<p>
We already know (we can see in the formulas above) that \(E\) decreases as \(n\) increases. Now we would like to use this information to our advantage: suppose that we have a fixed margin of error \(E,\) say \(E=3\), and we want a \(100(1-\alpha)\%\) confidence interval for \(\mu\). The question is: how big does \(n\) have to be?
</p>
<p>
For the case of a population mean the answer is easy: we set up an equation and solve for \(n\).
</p>
<p>
Given a situation, given \(\sigma\), given \(E\), we would like to know how big \(n\) has to be to ensure that \(\overline{X}\pm5\) is a 95% confidence interval for \(\mu\).
</p>
<p>
<div class="rem">
Always round up any decimal values of \(n\), no matter how small the decimal is. Another name for \(E\) is the ``maximum error of the estimate''.
</div>
</p>
<p>
For proportions, recall that the asymptotic formula to estimate \(p\) was
\[
\hat{p}\pm z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}.
\]
Reasoning as above we would want
\begin{align}
E & =z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}},\mbox{ or}\\
n & =z_{\alpha/2}^{2}\frac{\hat{p}(1-\hat{p})}{E^{2}}.\label{eq:samp-size-prop-ME}
\end{align}
OOPS! Recall that \(\hat{p}=Y/n\), which would put the variable \(n\) on both sides of Equation <a href="#eq-samp-size-prop-ME">samp-size-prop-ME</a>. Again, there are two solutions to the problem.
</p>
<ol>
<li>If we have a good idea of what \(p\) is, say \(p^{\ast}\) then we can plug it in to get
   \begin{equation}
   n=z_{\alpha/2}^{2}\frac{p^{\ast}(1-p^{\ast})}{E^{2}}.
   \end{equation}
</li>
<li>Even if we have no idea what \(p\) is, we do know from calculus that \(p(1-p)\leq1/4\) because the function \(f(x)=x(1-x)\) is quadratic (so its graph is a parabola which opens downward) with maximum value attained at \(x=1/2\). Therefore, regardless of our choice for \(p^{\ast}\) the sample size must satisfy
   \begin{equation}
   n=z_{\alpha/2}^{2}\frac{p^{\ast}(1-p^{\ast})}{E^{2}}\leq\frac{z_{\alpha/2}^{2}}{4E^{2}}.
   \end{equation}
   The quantity \(z_{\alpha/2}^{2}/4E^{2}\) is large enough to guarantee \(100(1-\alpha)\%\) confidence.
</li>
</ol>


<p>
Proportion example.
</p>
<p>
<div class="rem">
For very small populations sometimes the value of \(n\) obtained from the formula is too big. In this case we should use the hypergeometric distribution for a sampling model rather than the binomial model. With this modification the formulas change to the following: if \(N\) denotes the population size then let
\begin{equation}
m=z_{\alpha/2}^{2}\frac{p^{\ast}(1-p^{\ast})}{E^{2}}
\end{equation}
and the sample size needed to ensure \(100(1-\alpha)\%\) confidence is achieved is
\begin{equation}
n=\frac{m}{1+\frac{m-1}{N}}.
\end{equation}
If we do not have a good value for the estimate \(p^{\ast}\) then we may use \(p^{\ast}=1/2\).
</div>
</p>

<p>
I am thinking about <code>power.t.test</code>, <code>power.prop.test</code>, <code>power.anova.test</code>, and I am also thinking about <code>replicate</code>.
</p>
</div>

</div>

<div id="outline-container-1-8" class="outline-3">
<h3 id="sec-1-8">Other Topics</h3>
<div class="outline-text-3" id="text-1-8">


<p>
Mention <code>mle</code> from the <code>stats4</code> package.
</p>

</div>

</div>

<div id="outline-container-1-9" class="outline-3">
<h3 id="sec-1-9">Exercises</h3>
<div class="outline-text-3" id="text-1-9">


<p>
<div class="xca">
Let \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) be an \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution. Find a two-dimensional MLE for \(\theta=(\mu,\sigma)\).
</div>
</p>
<p>
<div class="xca">
Find the upper and lower limits for the confidence interval procedure by finding the roots of \(f\) defined by 
\[
f(p)=\left(Y/n-p\right)^{2}-z_{\alpha/2}^{2}\frac{p(1-p)}{n}.
\]
You are going to need the quadratic formula.
</div>
</p></div>
</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2011-09-21 18:23:32 EDT</p>
<p class="author">Author: G. Jay Kerns</p>
<p class="creator">Org version 7.7 with Emacs version 23</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
